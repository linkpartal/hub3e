<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/mission.css') }}" />
    <link rel="stylesheet" href="{{ asset('css/PopUp.css') }}" />
    {% block CSS %}{% endblock %}

    <title>HUB3E - {% block title %}Home{% endblock %}</title>

</head>
<body>
<div id="MettreEnRelation" class="popup">
    <div onclick="hide(this)" class="close"></div>
    <div class="col-xs-offset-1 col-xs-9" style="padding: 0;border:20px solid white;display: block">

        <form id="formMettreEnRelation" class="formulaire" action="{{ path("MettreEnRelation_added") }}" onsubmit="document.getElementById('submitMettreEnRelation').disabled=true" method="post">

            <div class="div_form" >

                <div class="row" style=" margin: 0;">
                    <img class="col-xs-1" src="data:image/jpg;base64,{{ mission.getEtablissement.getTier.getLogo }}"
                         style="padding: 10px; height: 40px;">
                    <div class="col-xs-4">
                        <div class="col-xs-12"
                             style="height: 30px; text-align: left; padding: 10px;"><label style="font-family:Arial;font-style:normal;font-size: large;color:black" >{{ mission.getIntitule }}&nbsp; </label><label style="font-family:Arial;font-style:normal;font-size: large;color:#2A76CC" > {{ mission.getEtablissement.getTier.getRaisonsoc }}</label></div>
                        <div class="col-xs-12" style="height: 20px; text-align: left;font-family:Arial;font-style:normal;font-size: small">{{mission.getEtablissement.getAdresse }}, {{ mission.getEtablissement.getCodePostal }} {{ mission.getEtablissement.getVille }}</div>
                    </div>

                    <div class=" col-xs-1">
                        <div class="col-xs-12" style="height: 20px;color: #666666;font-family:Arial;font-style:normal;margin-right: 200px">{{mission.getCodemission }}</div>
                    </div>
                </div>


                <textarea style="height: 100px;resize: none;" class="input" id="Descriptif" name="_Descriptif" placeholder="Cette mission peut vous intÃ©resser,postuler si vous le souhaitez ..." required ></textarea>


            </div>
            <div class="div_button">
                <input id="submitAnnuler" class="blue" type="submit" value="Annuler">
                <input id="submitMettreEnRelation" class="blue" type="submit" value="Mettre en relation">

            </div>
        </form>







    </div>
</div>
<div class="container" style="padding: 0;">


    <div class="row" style=" margin: 0;">
        <img class="col-xs-1" src="data:image/jpg;base64,{{ mission.getEtablissement.getTier.getLogo }}"
             style="padding: 10px; height: 40px;">
        <div class="col-xs-4">
            <div class="col-xs-12"
                 style="height: 30px; text-align: left; padding: 10px;"><label style="font-family:Arial;font-style:normal;font-size: large;color:black" >{{ mission.getIntitule }}&nbsp; - &nbsp;  </label><label style="font-family:Arial;font-style:normal;font-size: large;color:#2A76CC" > {{ mission.getEtablissement.getTier.getRaisonsoc }}</label></div>
            <div class="col-xs-12" style="height: 20px; text-align: left;font-family:Arial;font-style:normal;font-size: small">{{mission.getEtablissement.getAdresse }}, {{ mission.getEtablissement.getCodePostal }} {{ mission.getEtablissement.getVille }}</div>
        </div>
        <div class="col-xs-offset-5 col-xs-1">
            <div class="col-xs-12" style="height: 30px;; padding-top: 10px;"><label style="font-size:large;color:#2A76CC;" > 18</label></div>
            <div class="col-xs-12" style="height: 20px;width:100px;color: #666666;font-family:Arial;font-style:normal;">mises en relation</div>
        </div>
        <div class=" col-xs-1">
            <div class="col-xs-12" style="height: 30px; padding-top: 10px;"><label style="font-size: large;color:#2A76CC" > 5</label></div>
            <div class="col-xs-12" style="height: 20px;color: #666666;font-family:Arial;font-style:normal;">candidatures</div>
        </div>
    </div>




<div class="row" >

    <button onclick="moveto(this,'info_mission')" class="col-xs-4 onglet"  type="button" > FICHE MISSION</button>
    <button onclick="moveto(this,'apprenants_mission')" class="col-xs-4 onglet"  type="button" >LISTE DES APPRENANTS</button>
    <button onclick="moveto(this,'map')" class="col-xs-4 onglet"  type="button"  >CARTE DES APPRENANTS</button>
    <div id="baronglet" class="col-xs-4" style="height: 5px;background-color: #257ef0; z-index: 60;"></div>
</div>



    <div id="info_mission" style="border-top: 1px solid #B0B0B0;background-color:  rgb(238, 241, 246);margin: 0;overflow-y: auto;width: 100%;height: 100%;position: absolute;">
        <div class="col-xs-9" style="background: rgb(238, 241, 246); height: 100%;">

            <div class="col-xs-12" style="margin-bottom: 50px">
                <div class="list-group affichage">

                    <label class="list-group-item mission" >LA MISSION : <br/>
                        <label  style="color:black; font-weight: lighter" >{{mission.getDescriptif}}</label>
                    </label>

                    <label class="list-group-item mission" >LE PROFIL RECHERCHE :<br/>
                        <label style="color:black; font-weight: lighter" >{{mission.getProfil}}</label>
                    </label>


                    <label class="list-group-item mission">Domaine : <br/>
                        <label style="color:black; font-weight: lighter" >{{mission.getDomaine}}</label>
                    </label>


                </div>
            </div>
        </div>
        <div class="col-xs-3"
             style="height: 100%;">
            <div class="list-group"
                 style="margin: 15px 0 0 15px;height: 100%; background-color: white;">
                <div  class="rightMenu " >
                    <div style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-time" aria-hidden="true"></span>
                        {{mission.getDate|date('d/m/Y a H:i')}}
                    </div>
                </div>
                <div class="rightMenu" >
                    <div  style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-user" aria-hidden="true"></span>
                        {{mission.getTuteur}}
                    </div>
                </div>
                <div class="rightMenu" >
                    <div style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-envelope" aria-hidden="true"></span>
                        {{mission.getEmailcontact}}
                    </div>
                </div>
                <div class="rightMenu" >
                    <div  style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-list-alt" aria-hidden="true"></span>
                        {{mission.getTypecontrat}}
                    </div>
                </div>
                <div  class="rightMenu " >
                    <div style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                        {{mission.getDatedebut|date('d/m/Y')}}
                    </div>
                </div>
                <div  class="rightMenu " >
                    <div style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-calendar" aria-hidden="true"></span>
                        {{mission.getDatefin|date('d/m/Y')}}
                    </div>
                </div>
                <div class="rightMenu" >
                    <div style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-eur" aria-hidden="true"></span>
                        {{mission.getRemuneration}}
                    </div>
                </div>
                <div class="rightMenu" >
                    <div  style="text-align:center;line-height:50px;" >
                        <span class="glyphicon glyphicon-qrcode" aria-hidden="true"></span>
                        {{mission.getCodemission}}
                    </div>
                </div>

                <button onclick="post('{{ path('modifierMission',{'id': mission.getId }) }}',false)" type="button" class="list-group-item rightMenu" >
                    <div class="col-xs-12"  >Modifier la fiche</div>
                </button>

                <button onclick="post('{{ path('supprimer_Mission',{'id': mission.getId }) }}',true)" type="button" class="list-group-item rightMenu" >
                    <div class="col-xs-12" >Supprimer Mission</div>
                </button>

            </div>

        </div>



    </div>

    <div id="apprenants_mission" style="border-top: 1px solid #B0B0B0;background-color:  rgb(238, 241, 246);margin: 0;overflow-y: auto;width: 100%;height: 90%;visibility: hidden;position: absolute;">
        <div class="row" style="margin:10px 0 0 10px"  >
            <div>
                <span class="glyphicon glyphicon-search" ></span>
                <input type="text" class="input" placeholder="Recherche" style="padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px;height:33px;margin-right:800px" >

                <button type="button"style="font-family: Verdana; font-style:normal ;font-size:medium; height: 20px; border-radius: 0; background: none; border: 0;color: #666666 ;">
                    Filtres <span class="glyphicon glyphicon-menu-down" aria-hidden="true" ></span>
                </button>
            </div>

        </div>



        <div class="row" style="height: 150px; margin:10px;background:white">

            {% if users is defined %}
                {% for user in users %}
                    {% if user.hasRole('ROLE_APPRENANT') %}
                        <div class="col-xs-12 Liste">


                            <label style="width:40px;height: 20px;background:yellowgreen;color:white;font-family: Arial; font-style:normal ;font-size:small;position: absolute;left: 0;z-index: 6;margin: 10px 0 0 10px;">100</label>
                            <label style="width:10px;height:140px;background:yellowgreen;color:white;position: absolute;left: 0;z-index: 5;margin: 10px 0 0 10px;"></label>

                            <img class="col-xs-1" src="data:image/jpg;base64,{{ user.getPhotos }}" style="margin: 10px 0 0 10px;height: 140px;width: 140px;">

                            <div class="col-xs-4" style="margin-left: 10px;margin-top:10px">
                                <div class="col-xs-12"
                                     style="height: 30px; text-align: left; padding: 10px;margin-bottom: 15px;"><label style="color:black" >{{user.getPrenom}}  {{user.getNom}} </label> &nbsp;&nbsp; </label>

                                    <button style="background:yellowgreen; border-radius:50%; width:15px; height:15px; border:2px solid yellowgreen;"></button>&nbsp;&nbsp;

                                    <label style="font-family:Arial;font-style:normal;font-size:medium;" > 5.0 </label>&nbsp;&nbsp;<img src="{{ asset('image/bookmark50.png') }}"></div>

                                <div class="col-xs-12" style="margin-bottom: 5px;height: 20px; text-align: left; font-family:Arial;font-style:normal;font-size:small">RECHERCHE : DEVELOPPEMENT INFORMATIQUE </div>
                                <div class="col-xs-12" style="margin-bottom: 5px;height: 20px; text-align: left; font-family:Arial;font-style:normal;font-size:small">CONTRAT : CONTRAT PRO/STAGE/TEMPS PLEIN</div>


                                <div class="col-xs-12" style="margin-bottom: 5px;height: 20px; text-align: left; font-family:Arial;font-style:normal;font-size:small">STATUT : <label style="color:#2975cb">3 MISES EN RELATION</label></div>


                            </div>
                            <div class="col-xs-offset-5 col-xs-1">


                                <button  onclick="show('MettreEnRelation')" type="button"  style=" width:150px;height: 30px;border:none;padding:6px 0 6px 0;border-radius:8px;background:#2975cb;font:bold 13px Arial;margin-bottom:10px;margin-top: 20px">
                                    <div class="col-xs-12" style="display: inline-table;color: white;">METTRE EN RELATION</div>
                                </button>

                                <button  type="button"  style=" background:white;width:150px;height:30px;border:none;padding:6px 0 6px 0;border-radius:8px;font:bold 13px Arial;border:1px solid #ccc;margin-bottom:10px" >
                                    <div class="col-xs-12"  style="display: inline-table;color: #adadad;" >FICHE CONTACT</div>

                                </button>

                                <button  type="button"  style="background-color: white ;width:150px;height: 30px;border:none;padding:6px 0 6px 0;border-radius:8px;font:bold 13px Arial;border:1px solid #ccc;" >
                                    <div class="col-xs-12" style="display: inline-table;color: #adadad;" >PLUS</div>

                                </button>



                            </div>


                        </div>
                    {% endif %}
                {% endfor %}
            {% endif %}


        </div>







    </div>

    <div id="map" style="height: 100%;width: 100%;position: absolute;visibility: hidden;">

    </div>
    <div id="wrapper" class="infobox-wrapper">
        <div id="infobox" style="">
            <div id="inbox" >
                <div style="background-image: url('{{ asset('image/image1.jpg') }}');background-size: 45px 45px">
                </div>
            </div>

        </div>
    </div>
</div>
<script src="//code.jquery.com/jquery.min.js"></script>
<!--script src="https://maps.googleapis.com/maps/api/js?callback=initMap" async defer></script-->
<script type="text/javascript" src="http://maps.google.com/maps/api/js"></script>
<script type="text/javascript" src="http://google-maps-utility-library-v3.googlecode.com/svn/trunk/infobox/src/infobox.js"></script>
<script src="{{ asset('js/bootstrap.min.js') }}"></script>
<script src="{{ asset('js/PopUp.js') }}"></script>
<script language="JavaScript">
    var infoWindows = [];
    function moveto(button,div) {
        var elem = document.getElementById("baronglet");
        var pos = elem.offsetLeft;
        document.getElementById('info_mission').style.visibility= 'hidden';
        document.getElementById('apprenants_mission').style.visibility= 'hidden';
        document.getElementById('map').style.visibility= 'hidden';
        for (var i=0;i<infoWindows.length;i++) {
            infoWindows[i].close();
        }
        document.getElementById(div).style.visibility= 'visible';
        var end = false;
        var id = setInterval(frame, 5);

        function frame() {
            if (pos == button.offsetLeft || (pos ==0 && end)) {
                clearInterval(id);
            } else {
                if(elem.offsetLeft > button.offsetLeft)
                {
                    end = true;
                    elem.style.left = pos-- + 'px';
                }
                else
                {
                    elem.style.left = pos++ + 'px';
                }
            }
        }
    }

    {% if User is defined %}
    document.getElementById("select_info").onchange = function(){
        var x = document.getElementById("select_info").value;
        document.getElementById('info_user').style.display= 'none';


        document.getElementById(x).style.display='block';
    };

    {% endif %}

    function post(path,refresh) {
        if(refresh)
        {
            $.ajax({
                type: 'get',
                url: path,
                error: function () {
                    alert('Une erreur s\'est produite');
                },
                success: function () {
                    window.parent.location.reload();
                }
            });
        }
        else
        {
            window.location = path;
        }
    }
    function submitform(form) {
        document.getElementById(form).submit();
    }
    /*function initMap() {
        var geoloc = '{{ mission.getEtablissement.getGeocode }}';
        geoloc = geoloc.substring(1,geoloc.length - 1).split(',');
        var lat = parseFloat(geoloc[0]);
        var long = parseFloat(geoloc[1]);

        var uluru = {lat: lat, lng: long};
        var map = new google.maps.Map(document.getElementById('map'), {
            zoom: 18,
            center: uluru
        });

        var contentString = '<div id="content" style="background-color: #232d37;  box-shadow: 0px 6px 4px 0px rgba(0, 0, 0, 0.25);  width: 235px;  height: 314px;  z-index: 89;">' +
                '<div style="background-color: #202830; width: 235px;  height: 60px;  z-index: 90;">'+
                '<div src="" style="border: 2px solid rgb(23, 29, 35);  border-radius: 50%;'+
                'background-color: rgb(255, 255, 255); margin: 0 auto;top:30px;position: relative;  width: 70px;  height: 70px;  z-index: 97;"></div>'+
                '</div>'+

                '</div>';

        var infowindow = new google.maps.InfoWindow({
            content: contentString
        });

        var marker = new google.maps.Marker({
            position: uluru,
            map: map,
            title: 'Uluru (Ayers Rock)'
        });
        marker.addListener('click', function() {
            infowindow.open(map, marker);
        });
    }*/
    function initialize() {
        var loc, map, marker, infobox;
        var geoloc = '{{ mission.getEtablissement.getGeocode }}';
        geoloc = geoloc.substring(1,geoloc.length - 1).split(',');
        var lat = parseFloat(geoloc[0]);
        var long = parseFloat(geoloc[1]);

        loc = new google.maps.LatLng(lat,long);

        map = new google.maps.Map(document.getElementById("map"), {
            zoom: 18,
            center: loc,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });

        marker = new google.maps.Marker({
            map: map,
            position: loc,
            visible: true,
            title: 'jdjdjd'
        });

        infobox = new InfoBox({
            content: document.getElementById("infobox")
            ,disableAutoPan: false
            ,maxWidth: 0
            ,pixelOffset: new google.maps.Size(-76, -212)
            ,zIndex: null
            ,closeBoxMargin: "4px 4px 4px 4px"
            ,closeBoxURL: "http://www.google.com/intl/en_us/mapfiles/close.gif"
            ,infoBoxClearance: new google.maps.Size(1, 1)
            ,isHidden: false
            ,pane: "floatPane"
            ,enableEventPropagation: false
        });
        infoWindows.push(infobox);
        google.maps.event.addListener(marker, 'click', function() {
            infobox.open(map, this);
            map.panTo(loc);
        });
    }
    google.maps.event.addDomListener(window, 'load', initialize);
</script>
</body>
</html>