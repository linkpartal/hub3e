<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/html">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/SuperUser.css') }}" />
    <link rel="stylesheet" href="{{ asset('css/ajout.css') }}" />
    <link rel="stylesheet" href="{{ asset('css/PopUp.css') }}" />
    {% block CSS %}{% endblock %}

    <title>HUB3E - {% block title %}Home{% endblock %}</title>

</head>
<body>

<div class="container" style="padding: 0;">
    {% block Content %}
    {% if User is defined %}
    <div class="row" style="background-color:  rgb(238, 241, 246);margin: 0;overflow-y: auto;height: 100%">

        <div class="col-xs-9"
             style="background: rgb(238, 241, 246); height: 100%;">

            <!-- **********************************tache des apprenants************************** -->
            <div class="col-xs-12" style="height: 46px;">
                <div style="height: 35px; width: 100%; padding: 15px 0 0 15px;">

                    {% if User.hasRole('ROLE_APPRENANT') %}
                        <select title="" id="select_info"  style="color:white;">
                            <option value="info_user" style="color:black;">Données Utilisateur</option>
                            <option value="info_Apprenant" style="color:black;">Details de l'Apprenant</option>
                            <option value="info_candidature" style="color:black;">Formation de l'Apprenant </option>
                            <option value="info_parents" style="color:black;">Les Parents </option>
                            <option value="info_Exp" style="color:black;">Expériences </option>
                            <option value="info_recom" style="color:black;">Recommandations </option>
                            <option value="info_diplome" style="color:black;">Diplomes </option>
                            <option value="info_doc" style="color:black;">Documents </option>
                            <option value="QCM_Affinite" style="color:black;">QCM Affinite </option>
                        </select>

                        {% else  %}
                            <Label value="info_user" style="font:20px arial;width: 100%; height: 40px;border-radius: 0; background: #1C5AA5; border: 0; color: white;text-align: left;">Données Utilisateur</Label>
                    {% endif %}
                </div>
            </div>



            <div class="col-xs-12" style="margin-bottom: 50px">
                <div id="info_user" class="list-group affichage">

                    <form class="formulaire" id="formUser" action="{{ path('userModif') }}" method="post" enctype="multipart/form-data">

                        <input type="hidden" value="{{ User.getId }}" id="id" name="_ID">

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="civilite">Civilité :</label>

                            <select   class="champ form-control " style="width: 25%; margin-right: 10px;background-color: white" title="" id="civilite"  name="_Civilite">
                                {% if User.getCivilite == 'Mr' %}
                                    <option selected="selected" value="Mr">Mr.</option>
                                {% else %}
                                    <option value="Mr">Mr.</option>
                                {% endif %}

                                {% if User.getCivilite == 'Mme' %}
                                    <option selected="selected" value="Mme">Mme.</option>
                                {% else %}
                                    <option value="Mme">Mme.</option>
                                {% endif %}

                                {% if User.getCivilite == 'Mlle' %}
                                    <option selected="selected" value="Mlle">Mlle.</option>
                                {% else %}
                                    <option value="Mlle">Mlle.</option>
                                {% endif %}
                            </select>
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Nom">Nom :</label>
                            <input value="{{User.getNom}}" type="text" class="champ form-control" id="Nom" name="_Nom" maxlength="45" readonly>
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Prenom">Prénom :</label>
                            <input value="{{User.getPrenom}}" type="text" class="champ form-control" id="Prenom" name="_Prenom" maxlength="45" readonly>
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Tel">Téléphone :</label>
                            <input value="{{User.getTelephone}}" type="text" class="champ form-control"id="Telephone" name="_Tel" maxlength="45" readonly>
                        </div>


                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="UserName">UserName :</label>
                            <input value="{{User.getUserName}}" type="text" class="champ form-control" id="UserName" name="_Username" maxlength="255" readonly>
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Mail">E-mail :</label>
                            <input value="{{User.getEmail}}" type="text" class="champ form-control" id="Mail" name="_Mail" maxlength="255" readonly>
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" >Dernière connexion :</label><label style="color:black" >{{User.getLastLogin|date('d/m/Y')}}</label>

                        </div>
                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" >Expiré le : </label>
                            <label style="color:black" >

                                {% if User.getExpiredAt is null %}
                                    &nbsp;
                                {% else %}
                                    {{ User.getExpiredAt|date('d/m/Y H:i') }}
                                {% endif %}


                            </label>


                        </div>
                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;">Roles :
                                {% for role in User.getRoles %}
                                    <label style="color:black">{{role}}, </label>
                                {% endfor %}
                            </label>


                        </div>
                        <div class="inputcontainer">
                        {% if User.getEtablissement %}
                            {% if User.getEtablissement.getTier.getEcole == 0 %}
                                <label class="list-group-item info" >Société  : <label style="color:black" >{{User.getEtablissement.getTier.getRaisonSoc}}</label></label>

                            {% elseif User.getEtablissement.getTier.getEcole == 1 %}
                                <label class="list-group-item info" >Ecole  : <label style="color:black" >{{User.getEtablissement.getTier.getRaisonSoc}}</label></label>
                            {% endif %}
                        {% endif %}
                        </div>
                        <input id="formUserSubmit" type="submit" style="display: none;">
                    </form>
                </div>

                {% if User.hasRole('ROLE_APPRENANT') %}
                    <div id="info_Apprenant" class="col-xs-12 Liste" style="display:none;">
                    {% if User.GetInfo  %}
                        <div class="row">
                            <label class="cell" >Date naissance : <label style="padding:10px; border:solid 2px #7F7F7F;text-align:center;color:#666666;width:250px;" >{{User.getInfo.getDatenaissance|date('d/m/Y ') }}</label></label>
                            <label class="cell" >Cp naissance  : <label style="padding:10px; border:solid 2px #7F7F7F;text-align:center;color:#666666;width:250px;" >{{User.getInfo.getCpnaissance}}</label></label>
                        </div>
                        <div class="row">
                            <label class="cell" >Lieu naissance: <label style="padding:10px; border:solid 2px #7F7F7F;text-align:center;color:#666666;width:250px;" >{{User.getInfo.getLieunaissance}}</label></label>
                            <label class="cell" >Adresse       : <label style="padding:10px; border:solid 2px #7F7F7F;text-align:center;color:#666666;width:250px;" >{{User.getInfo.getAdresse}}</label></label>
                        </div>
                        <div class="row">
                            <label class="cell" >Facebook      : <label style="color:black;padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px" >{{User.getInfo.getFacebook}}</label></label>
                            <label class="cell" >Linkedin      : <label style="color:black;padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px" >{{User.getInfo.getLinkedin}}</label></label>
                        </div>
                        <div class="row">
                            <label class="cell" >Mobilite      : <label style="color:black;padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px" >{{User.getInfo.getMobilite}}</label></label>
                            <label class="cell" >Fratrie       : <label style="color:black;padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px" >{{User.getInfo.getFratrie}}</label></label>
                        </div>
                        <div class="row">
                            <label class="cell" >Hobbies :
                                {% for hobby in User.getHobbies %}
                                    <label style="color:black;padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px" > {{ hobby.gethobby }},</label>
                                {% endfor %}
                            </label>
                        </div>
                        <div class="row">
                            <label class="cell" >Langue :
                                {% if Langue is defined %}
                                    {% for lang in Langue %}
                                        <label style="color:black;padding:5px; border:solid 1px black; color:steelblue; border-radius:5px;width:200px" >{{ lang.getLangue }},</label>
                                    {% endfor %}
                                {% endif %}
                            </label>
                        </div>
                    {% endif %}

                    </div>
                    <div id="info_parents" class="list-group affichage" style="display:none">
                        {% if Parents is defined %}
                            {% for parent in Parents %}
                                {% set iddiv = random()  %}
                                <div class="col-xs-12 Liste">
                                    <div class="row">
                                        <label class="cell">Nom : <label>{{ parent.getNom }}</label></label>
                                        <label class="cell">Prénom : <label>{{parent.getPrenom }}</label>
                                            <button class="button" style="float: right;" type="button" data-toggle="collapse" data-target="#parent{{ iddiv }}"></button></label>
                                    </div>
                                    <div id="parent{{ iddiv }}" class="collapse in" >
                                        <div class="row">
                                            <label class="cell">Telephone : <label>{{ parent.getTelephone }}</label></label>
                                            <label class="cell">Adresse  : <label>{{ parent.getAdresse }}</label></label>
                                        </div>
                                        <div class="row">
                                            <label class="cell">Email : <label>{{ parent.getEmail}}</label></label>
                                            {% if parent.getNomjeunefille  %}
                                                <label class="cell">Nom jeune fille  : <label>{{ parent.getNomjeunefille }}</label></label>
                                            {% endif %}
                                        </div>
                                    </div>

                                </div>
                            {% endfor %}
                        {% endif %}

                    </div>
                    <div id="info_Exp" class="list-group affichage" style="display:none">
                        {% if Experience is defined %}
                            {% for Exp in Experience %}
                                {% set iddiv = random()  %}
                                <div class="col-xs-12 Liste">
                                    <div class="row">
                                        <label class="cell">Nom societe : <label>{{ Exp.getNomsociete }}</label></label>
                                        <label class="cell">Activite : <label>{{Exp.getActivite }}</label>
                                            <button class="button" style="float: right;" type="button" data-toggle="collapse" data-target="#exp{{ iddiv }}"></button></label>

                                    </div>
                                    <div id="exp{{ iddiv }}" class="collapse in" >
                                        <div class="row">
                                            <label class="cell">Lieu  : <label>{{ Exp.getLieu }}</label></label>
                                            <label class="cell">Poste  : <label>{{ Exp.getPoste }}</label></label>
                                        </div>
                                        <div class="row">
                                            <label class="cell">Nbreannee : <label>{{ Exp.getNbreannee}}</label></label>
                                            <label class="cell">Description : <label>{{ Exp.getDescription }}</label></label>

                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                    </div>
                    <div id="info_recom" class="list-group affichage" style="display:none">
                        {% if Recommandation is defined %}
                            {% for Recom in Recommandation %}
                                {% set iddiv = random()  %}
                                <div class="col-xs-12 Liste">
                                    <div class="row">
                                        <label class="cell">Text  : <label>{{ Recom.getText }}</label></label>
                                        <label class="cell">Nom : <label>{{Recom.getNom }}</label>
                                            <button class="button" style="float: right;" type="button" data-toggle="collapse" data-target="#recommandation{{ iddiv }}"></button></label>

                                    </div>
                                    <div id="recommandation{{ iddiv }}" class="collapse in" >
                                        <div class="row">
                                            <label class="cell">Fonction  : <label>{{ Recom.getFonction }}</label></label>
                                            <label class="cell">Email  : <label>{{ Recom.getEmail }}</label></label>
                                        </div>
                                        <div class="row">
                                            <label class="cell">Téléphone : <label>{{ Recom.getTelephone}}</label></label>

                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                    </div>
                    <div id="info_diplome" class="list-group affichage" style="display:none">
                        {% if Diplome is defined %}
                            {% for Dip in Diplome %}
                                {% set iddiv = random()  %}
                                <div class="col-xs-12 Liste">
                                    <div class="row">
                                        <label class="cell">Text  : <label>{{ Dip.getLibelle }}</label></label>
                                        <label class="cell">Obtention : <label>{{Dip.getObtention }}</label>
                                            <button class="button" style="float: right;" type="button" data-toggle="collapse" data-target="#diplome{{ iddiv }}"></button></label>

                                    </div>
                                    <div id="diplome{{ iddiv }}" class="collapse in" >
                                        <div class="row">
                                            <label class="cell">Ecole  : <label>{{ Dip.getEcole}}</label></label>

                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                    </div>
                    <div id="info_doc" class="list-group affichage" style="display:none">
                        {% if Document is defined %}
                            {% for Doc in Document %}
                                {% set iddiv = random()  %}
                                <div class="col-xs-12 Liste">
                                    <div class="row">
                                        <label class="cell">Type   : <label>{{ Doc.getType }}</label></label>
                                        <label class="cell">Extention : <label>{{Doc.getExtension }}</label>
                                            <button class="button" style="float: right;" type="button" data-toggle="collapse" data-target="#doc{{ iddiv }}"></button></label>

                                    </div>
                                    <div id="doc{{ iddiv }}" class="collapse in" >
                                        <div class="row">
                                            <label class="cell">Taille  : <label>{{ Doc.getTaille}}</label></label>


                                        </div>
                                    </div>
                                </div>
                            {% endfor %}
                        {% endif %}

                    </div>
                    <div id="info_candidature" class="list-group affichage" style="display:none">
                        {% if candidatures is defined %}
                        {% for candidature in candidatures %}
                            {% set iddiv = random()  %}
                            <div class="col-xs-12 Liste">
                                <div class="row">
                                    <label class="cell">Id : <label>{{ candidature.id }}</label></label>
                                    <label class="cell">Statut : <label>
                                            {% if is_granted('ROLE_RECRUTEUR') or is_granted('ROLE_TUTEUR') %}
                                                {% if candidature.statut == 1 %}
                                                    En attente compléments
                                                {% elseif candidature.statut == 2 %}
                                                    En attente validation
                                                {% elseif candidature.statut == 3 %}
                                                    Validé
                                                {% elseif candidature.statut == 99 %}
                                                    Refusé
                                                {% endif %}
                                            {% elseif is_granted('ROLE_APPRENANT') %}
                                                {% if candidature.statut == 1 %}
                                                    A compléter
                                                {% elseif candidature.statut == 2 %}
                                                    En attente école
                                                {% elseif candidature.statut == 3 %}
                                                    Admis
                                                {% elseif candidature.statut == 99 %}
                                                    Ajourné
                                                {% endif %}
                                            {% endif %}
                                        </label>
                                        <button class="button" style="float: right;" type="button" data-toggle="collapse" data-target="#parent{{ iddiv }}"></button></label>
                                </div>
                                <div id="parent{{ iddiv }}" class="collapse in" >
                                    <div class="row">
                                        <label class="cell">Ecole  : <label>{{ candidature.formation.etablissement.tier.raisonsoc }}</label></label>
                                        <label class="cell">Adresse : <label>{{ candidature.formation.etablissement.adresse }}</label></label>
                                    </div>
                                    <div class="row">
                                        <label class="cell">Formation : <label>{{ candidature.formation.nom }}</label></label>
                                        <label class="cell">Date : <label>{{ candidature.datecandidature|date('d/m/Y') }}</label></label>
                                    </div>
                                </div>

                            </div>
                        {% endfor %}
                        {% endif %}
                    </div>
                    <div id="QCM_Affinite" class="list-group affichage" style="display:none">

                        <div class="col-xs-12">
                            <div class="list-group" style="background: #1B2024; margin: 30px 0 0 30px; padding: 0 0; border-left: 20px solid white; border-right: 20px solid white !important; text-align: left;">


                                <form class="formulaire" id="form" action="{{ path('Add_QCM') }}" method="post">
                                    {% set i = 0 %}
                                    {% set reponsegroupe = 0 %}
                                    {% if QCMs is defined %}
                                    {% for QCM in QCMs %}
                                        <div class="inputcontainer" name="21456dddd">
                                            <label class="list-group-item" style="height: 60px;" for="QCM">Nom du Questionnaire :</label>
                                            <input type="text" class="champ " id="QCM" name="_Nom" value="{{ QCM.getNom }}" required maxlength="45" readonly><br>
                                        </div>
                                        {% set y = 0 %}
                                        {% for question in Questions[i] %}
                                            <div class="inputcontainer" name="question">
                                                <label class="list-group-item" style="height: 60px;" for="Question">Question :</label>
                                                <input type="text" class="champ " id="Question" name="questions[]" value="{{question.getQuestion  }}" required maxlength="255" readonly>
                                                {% for reponse in reponses[i][y] %}
                                                    <div>
                                                        <input type="radio" name="reponse[{{ reponsegroupe }}]" value="{{ reponse.getId }}"  ><label style="font: 14px Roboto black; ">{{ reponse.getReponse }}</label>
                                                    </div>
                                                {% endfor %}
                                            </div>
                                            {% set y = y + 1 %}
                                        {% endfor %}
                                        {% set reponsegroupe = reponsegroupe + 1 %}
                                        {% set i = i + 1 %}
                                    {% endfor %}
                                    {% endif %}
                                    
                                </form>
                            </div>
                        </div>

                    </div>
                {% endif %}




            </div>

        </div>

        <div class="col-xs-3"
             style="height: 100%;">
            <div class="list-group"
                 style="margin: 15px 0 0 15px;height: 100%; background-color: white;">
                {% if not User.isExpired %}
                    <button onclick="expire('{{ path('expired',{'id':User.getId}) }}')" id="expired" type="button" class="list-group-item rightMenu" style="background-color: #94C400">
                        <div class="col-xs-12" style="display: inline-table;color: white;height: 46px;margin-top:10px;">Activer</div>
                    </button>
                {% else %}
                    <button onclick="expire('{{ path('expired',{'id':User.getId}) }}')" id="expired" type="button" class="list-group-item rightMenu" style="background-color: red">
                        <div class="col-xs-12" style="display: inline-table;color: white;height: 46px;margin-top:10px;">Désactiver</div>
                    </button>
                {% endif %}
                <button onclick="modifier('formUser',this)" type="button" class="list-group-item rightMenu" >
                    <div class="col-xs-12"  >Modifier la fiche</div>

                </button>

                <button onclick="post('{{ path('supprimerUtilisateur',{'id': User.getId }) }}',true)" type="button" class="list-group-item rightMenu" >
                    <div class="col-xs-12" >Supprimer l'utilisateur</div>

                </button>

            </div>
        </div>

    </div>


    {% endif %}
    {% endblock %}
</div>
<script src="//code.jquery.com/jquery.min.js"></script>
<script src="{{ asset('js/bootstrap.min.js') }}"></script>
<script src="{{ asset('js/PopUp.js') }}"></script>
<script language="JavaScript">
    {% if User is defined %}
    document.getElementById("select_info").onchange = function(){
        var x = document.getElementById("select_info").value;
        document.getElementById('info_user').style.display= 'none';
        document.getElementById('info_Apprenant').style.display= 'none';
        document.getElementById('info_parents').style.display= 'none';
        document.getElementById('info_Exp').style.display= 'none';
        document.getElementById('info_recom').style.display= 'none';
        document.getElementById('info_diplome').style.display= 'none';
        document.getElementById('info_doc').style.display= 'none';
        document.getElementById('info_candidature').style.display= 'none';


        document.getElementById(x).style.display='block';
    };
    function expire(route) {
        $.ajax({
            type: 'get',
            url: route,
            error: function (response) {
                console.log(response);
            },
            success: function (data) {
                if (data['succes'] == '0') {
                    document.getElementById("expired").style.backgroundColor = '#94C400';
                    document.getElementById("expired").firstElementChild.innerHTML = 'Activer';
                    window.parent.document.getElementById('active{{ User.getId }}').style.backgroundColor = '#94C400';
                }
                else {
                    document.getElementById("expired").style.backgroundColor = 'red';
                    document.getElementById("expired").firstElementChild.innerHTML = 'Désactiver';
                    window.parent.document.getElementById('active{{ User.getId }}').style.backgroundColor = 'red';
                }

            }
        });

    }

    function post(path,refresh) {
        if(refresh)
        {
            $.ajax({
                type: 'get',
                url: path,
                error: function () {
                    alert('Une erreur s\'est produite');
                },
                success: function () {
                    window.parent.location.reload();
                }
            });
        }
        else
        {
            window.location = path;
        }
    }
    function modifier(form,button){
        var formulaire =document.getElementById(form);
        for(var i=0; i< formulaire.getElementsByTagName("input").length ; i++)
        {
            formulaire.getElementsByTagName("input")[i].readOnly=false;
        }

        button.getElementsByTagName("div")[0].innerHTML="valider";
        button.setAttribute('onclick','document.getElementById(\'formUserSubmit\').click()');
    }
    {% endif %}
</script>
</body>
</html>