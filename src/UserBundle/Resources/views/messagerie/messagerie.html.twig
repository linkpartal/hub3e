<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/mission.css') }}" />
    <link rel="stylesheet" href="{{ asset('css/PopUp.css') }}" />
    {% block CSS %}{% endblock %}

    <title>HUB3E - {% block title %}Home{% endblock %}</title>

</head>
<body>


<div id="FicheApprenant" class="popup" >
    <div onclick="hide(this)" class="close"></div>
    <div class="col-xs-offset-1 col-xs-7" style="background-color: white;padding: 0;border:20px solid white;display: block; margin-left: 20%; ">

        <form id="formFicheApprenant" class="formulaire"   method="post">
            <div>
                <div class="col-lg-12" >
                    <img src="" style="border-radius:50%; width:50px; height:50px" >
                </div>
                <div class="col-lg-12">
                    <label id="Information_Apprenant_titre" style="color:black" ></label>
                </div>
                <div id="Information_Apprenant_titre_adresse" class="col-xs-12" style="height: 20px;color: #666666;font-family:Arial;font-style:normal;font-size: medium;margin-bottom: 40px"></div>
            </div>



            <div class="div_form"  id="information_apprenant" >
                <div class="row" style=" margin-bottom: 20px">

                    <div class="col-xs-12">
                        <label style="font-size: 40px;font-family: Rochester;color: rgb(61, 138, 212);line-height: 0.375;text-align: left;z-index: 30;transform: rotate(180deg);">,,</label>
                        <label id="Information_Apprenant_Message" style="height: 20px;color: #666666;font-family:Arial;font-style:italic;font-size:small;margin-bottom: 40px;">
                            Votre mission m'interesse,je serais heureux de vous rencontrer pour en discuter.
                        </label>
                    </div>
                    <div class="row" >
                        <button onclick="document.getElementById('info_apprenant').style.display ='block';document.getElementById('Localisation').style.display ='none';"
                                class="col-xs-4 onglet"  type="button" style="margin-left: 20px;width: 50%"> FICHE APPRENANT</button>
                        <button onclick="document.getElementById('Localisation').style.display ='block';document.getElementById('info_apprenant').style.display ='none';
                        var center = map_localisation.getCenter();
                        google.maps.event.trigger(map_localisation, 'resize');
                        map_localisation.setCenter(center);"
                                class="col-xs-4 onglet"  type="button" style="width: calc(50% - 50px)" >LOCALISATION</button>

                    </div>

                    <div id="info_apprenant" style="height: 281px;border-top: 1px solid #B0B0B0;margin: 0;overflow-y: auto;width: 100%;">
                        <div class="col-xs-12 Liste" >

                            <div class="col-xs-12" >
                                <label class="cell"  style="float:left;">Civilité : <label id="Information_Apprenant_Civilite"></label></label>
                            </div>
                            <div class="col-xs-10 ">
                                <label class="cell" style="float:left;">Nom : <label id="Information_Apprenant_Nom"></label> </label>
                            </div>
                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Prenom : <label id="Information_Apprenant_Prenom"></label></label>

                            </div>
                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Email  : <label id="Information_Apprenant_Email"></label></label>
                            </div>
                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Téléphone : <label id="Information_Apprenant_Telephone"></label></label>

                            </div>
                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Date naissance : <label id="Information_Apprenant_DateNaissance"  ></label></label>
                            </div>
                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Cp naissance  : <label id="Information_Apprenant_CpNaissance" ></label></label>

                            </div>

                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Lieu naissance: <label id="Information_Apprenant_LieuNaissance" ></label></label>
                            </div>
                            <div class="col-xs-10">
                                <label class="cell" style="float:left;">Adresse       : <label id="Information_Apprenant_Adresse" ></label></label>
                            </div>
                        </div>
                    </div>
                    <div id="Localisation"  style="border-top: 1px solid #B0B0B0;margin: 0;height: 281px;width: 100%;display:none;">

                    </div>
                </div>



            </div>

            <div class="div_form" id="proposerApprenant" style="display: none">
                <div class="row" style=" margin-bottom: 20px;">

                    <div class="col-xs-12" >
                        <textarea style="height: 200px;resize: none;" class="input" id="Descriptif" name="_Descriptif" placeholder="Votre profil nous intéresse,nous vous proposons une plage de rendez-vous en lien Doodle" required ></textarea>
                    </div>
                    <div class="col-xs-12">
                        <label style="text-align:left;width:100%;font-family: Arial">Proposer un lien externe pour la prise de rendez-vous (type Doodle) : </label>
                    </div>

                    <div class="col-xs-12">
                        <input style="text-align:left;font-family: Arial;width:100%">
                    </div>

                </div>
            </div>

            <div class="div_form" id="declinerApprenant" style="display: none" >

                <div class="row" style=" margin-bottom: 20px;">
                    <textarea style="height: 200px;resize: none;" class="input"  placeholder="Nous vous remercions pour l'intérêt porter à notre mission, cependant nous n'avons pas retenu votre profil ." required ></textarea>
                </div>

            </div>


            <div id="information_button" class="div_button">
                <input  onclick="show_formapprenant()" class="blue" style="background:white;color:#666666;border:1px solid #ccc;float: left" type="button" value="Décliner">
                <input id="submitReception" class="blue" type="button" onclick="this.parentNode.parentNode.parentNode.parentNode.style.display='none';" style="margin-left: 250px"  value="Répondre plus tard">
                <input onclick="show_formapprenantproposer()"  class="blue" type="button"   value="Proposer un rendez-vous">
            </div>
            <div id="decliner_button" class="div_button" style="display: none">
                <input id="submitAnnuler" onclick="FermerPopup('information_apprenant')" class="blue" style="background:white;color:#666666;border:1px solid #ccc;float: left" type="button" value="Annuler">
                <input id="submitDecliner" class="blue" type="submit"  style="margin-left: 390px" value="Décliner">

            </div>
            <div id="proposer_button" class="div_button" style="display: none">
                <input  class="blue" onclick="FermerPopup('information_apprenant')" style="background:white;color:#666666;border:1px solid #ccc;float: left;text-align: center ;width: 120px;height:50px" type="button" value="Annuler">
                <input id="submitReception" class="blue" type="submit" style="margin-left: 300px;text-align:center;width: 120px;height:50px"  value="Valider">

            </div>

        </form>

    </div>


</div>

<div id="info_messagerie" style="border-top: 1px solid #B0B0B0;background-color:  rgb(238, 241, 246);margin: 0;overflow-y: auto;width: 100%;height: 90%;position: absolute;">

    <div class="row" style="margin:10px 0 0 10px ;margin-bottom: 10px"  >
        <div>
            <select class="input" title="messages" style="margin-left: 20px;height:40px;width:200px">
                <option value="les messages">Tous les messages</option>
            </select>

                <label style="width:20px" id="startTimeLabel" visible="false"></label>

            <span class="glyphicon glyphicon-search" ></span>
            <input type="text" class="input" placeholder="Recherche" style="padding:5px; border:solid 1px #666666; color:#666666; border-radius:5px;width:200px;height:40px;margin-right:607px" >
            <input  class="blue" style="background:white;color:#666666;border:1px solid #ccc;height:40px;width: 40px;color:#257ef0" type="button" value="1">
            <input  class="blue" style="background:white;color:#666666;border:1px solid #ccc;height:40px;width: 40px;color:#257ef0" type="button" value="2">
            <button  class="blue" style="background:white;color:#257ef0;border:1px solid #ccc;height:40px;width: 40px" type="button" ><span class="glyphicon glyphicon-play" aria-hidden="true"></span></button>

        </div>
        </div>



    {% if messageies is defined %}
    {% for msg in messageies %}

        <div class="col-xs-12 Liste" style="border: 1px solid #ddd;width:90%;margin-right:5px;margin-bottom: 0;margin-top: 0;height:100px;" >
            <div class="col-xs-2" >
                <div style="border: 15px solid transparent">
                    <img   src="data:image/jpg;base64,{{msg.getExpediteur.getPhotos }}" style="height:70px;width:70px;margin:0 40px;border-radius: 100%">
                </div>


            </div>

            <div class="col-xs-1" style="margin-top:10px;text-align: left ">
                <label style="font:18px arial;margin-top: 40px" > {{ msg.getDate|date('d M') }} </label>
            </div>

            <div class="col-xs-6" style="margin-top:10px;text-align: left">
                <label style="font:18px arial ;margin-top: 20px;float:left;width: 100%" > {{ msg.getMessage }} </label><br>
                <label style="font:16px arial;float:left;width: 100%" > {{ msg.getMission.getIntitule }} - <label style="font:18px arial;color:#2A76CC" > {{ msg.getMission.etablissement.tier.raisonsoc }}</label> </label>
            </div>

            <div class="col-xs-offset-1 col-xs-1" style="margin-top:10px;">
                <label style="font:18px arial;margin-top: 30px" > Répondez </label>

            </div>
            <div onclick="informationApprenant('{{msg.getExpediteur.getPhotos}}','{{ msg.getExpediteur.getCivilite }}','{{ msg.getExpediteur.getNom }}','{{ msg.getExpediteur.getPrenom }}','{{ msg.getExpediteur.getEmail }}',
                    '{{ msg.getExpediteur.getTelephone }}','{{ msg.getExpediteur.getInfo.getDateNaissance|date("d/m/Y") }}','{{ msg.getExpediteur.getInfo.getCpNaissance }}','{{ msg.getExpediteur.getInfo.getLieunaissance }}',
                    '{{ msg.getExpediteur.getInfo.getAdresse }}','{{ msg.message }}');show('FicheApprenant');" class="col-xs-1" style="height: 100%">
                <span class="glyphicon glyphicon-option-vertical" style="margin-top:40px;height:20px;color:#8c8c8c"></span>

            </div>

        </div>

    {% endfor %}
    {% endif %}
</div>






<script src="//code.jquery.com/jquery.min.js"></script>
<!--script src="https://maps.googleapis.com/maps/api/js?callback=initMap" async defer></script-->
<script type="text/javascript" src="http://maps.google.com/maps/api/js"></script>
<script src="{{ asset('js/bootstrap.min.js') }}"></script>
<script src="{{ asset('js/PopUp.js') }}"></script>
<script language="JavaScript">
    var marker,map_localisation;
    function show_formapprenant() {
        document.getElementById('information_apprenant').style.display= 'none';
        document.getElementById('declinerApprenant').style.display= 'block';
        document.getElementById('information_button').style.display= 'none';
        document.getElementById('decliner_button').style.display= 'block';
    }
    function show_formapprenantproposer() {
        document.getElementById('information_apprenant').style.display= 'none';
        document.getElementById('proposerApprenant').style.display= 'block';
        document.getElementById('information_button').style.display= 'none';
        document.getElementById('proposer_button').style.display= 'block';
    }
    function show_formmission() {
        document.getElementById('information_mission').style.display= 'none';
        document.getElementById('declinerMission').style.display= 'block';
        document.getElementById('mission_button').style.display= 'none';
        document.getElementById('declinerMission_button').style.display= 'block';
    }
    function FermerPopup(div){
        document.getElementById('information_apprenant').style.display= 'block';
        document.getElementById('information_button').style.display= 'block';
        document.getElementById('proposerApprenant').style.display= 'none';
        document.getElementById('proposer_button').style.display= 'none';
        document.getElementById('declinerApprenant').style.display= 'none';
        document.getElementById('decliner_button').style.display= 'none';

    }
    function informationApprenant(image,civilite,nom,prenom,email,telephone,Datenaissance,cpnaissance,lieuNaissance,adresse,message) {
        document.getElementById('formFicheApprenant').getElementsByTagName('img')[0].src ='data:image/jpg;base64,' + image;
        document.getElementById('Information_Apprenant_Civilite').innerHTML = civilite;
        document.getElementById('Information_Apprenant_Nom').innerHTML = nom;
        document.getElementById('Information_Apprenant_Prenom').innerHTML= prenom;
        document.getElementById('Information_Apprenant_Email').innerHTML = email;
        document.getElementById('Information_Apprenant_Telephone').innerHTML =telephone;
        document.getElementById('Information_Apprenant_DateNaissance').innerHTML =Datenaissance;
        document.getElementById('Information_Apprenant_CpNaissance').innerHTML =cpnaissance;
        document.getElementById('Information_Apprenant_LieuNaissance').innerHTML =lieuNaissance;
        document.getElementById('Information_Apprenant_Adresse').innerHTML =adresse;
        document.getElementById('Information_Apprenant_titre').innerHTML= nom +' '+ prenom;
        document.getElementById('Information_Apprenant_titre_adresse').innerHTML = adresse;
        document.getElementById('Information_Apprenant_Message').innerHTML = message;
        if(marker)
        {
            marker.setMap(null);
        }

        var geocoder = new google.maps.Geocoder();

        geocoder.geocode({'address': adresse }, function (results, status) {
            if (status == google.maps.GeocoderStatus.OK) {

                marker = new google.maps.Marker({
                    map: map_localisation,
                    position: results[0].geometry.location,
                    visible: true,
                    icon: '{{ asset('image/highscore_marker.png') }}'
                });
                map_localisation.setCenter(results[0].geometry.location);
            }
            else {
                alert('Nous n\'avons pas réussi à localiser l\'adresse l\'apprenant qui est : ' + adresse);
            }
        });

    }
    function initialize() {
        var locations =[];
        var loc, map, marker;

        map_localisation = new google.maps.Map(document.getElementById("Localisation"), {
            zoom: 15,
            center: loc,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        });
    }
    google.maps.event.addDomListener(window, 'load', initialize);




</script>
</body>
</html>