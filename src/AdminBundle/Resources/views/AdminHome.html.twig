<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link rel="stylesheet" href="{{ asset('css/bootstrap.min.css') }}">
    <link rel="stylesheet" href="{{ asset('css/SuperUser.css') }}" />
    <link rel="stylesheet" href="{{ asset('css/PopUp.css') }}" />
    <link rel="icon" type="image/png" href="{{ asset('image/Logo_Hub_3e.png') }}" />
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,500,700' rel='stylesheet' type='text/css'>

    {% block CSS %}{% endblock %}

    <title>HUB3E - {% block title %}Home{% endblock %}</title>

</head>
<body onload="loading();putbadged()">
<div id="addtier" class="popup col-xs-3">

    <div onclick="hide(this)" class="close"></div>
    <div class="col-xs-offset-3 col-xs-6 formContainer">
        <span class="glyphicon glyphicon-remove" aria-hidden="true" style="float:right; height:40px; font-size:20px"onclick="this.parentElement.previousElementSibling.click();"> </span>

        <div id="div_adresse" name="ajouterAdresse" style="border-bottom: 10px;display: none;">

            <button class="toggle" type="button" data-toggle="collapse" style="background-color: rgb(215,215,215);height: 40px;border: none;margin-top: 40px;"  data-target="#demo"></button>
            <button class="toggle" type="button" style="background-color: rgb(215,215,215);height: 40px;border: none;margin-top: 40px;" onclick="supprimerAdresse(this)" >-</button>

            <div id="demo" class="collapse in">


                <label style="margin: 10px 0;text-transform: uppercase;font: input-group col-xs-118px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Adresse Secondaire</label>
                <label for="Adresse" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Siret</label>
                <input placeholder="Siret" class="input" onChange="VerifierSiret(this)"  type="text" id="SIRET" name="_SIRET[]" pattern=".{14}" maxlength="14" required>

                {#<button  class="blue" type="button" onclick="VerifierSiret(this)">Vérifier si la société existe</button>#}
                <label for="Adresse" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Rue</label>
                <input class="input" type="text" id="Rue" name="_Adresse[]" maxlength="45" required>

                <label for="CodeP" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Code postal</label>
                <label for="Ville" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Ville</label>
                <input class="input" type="text" id="CodeP" name="_CodeP[]" style="width: calc(50% - 10px); margin-right: 10px" maxlength="10" required>
                <input class="input" type="text" id="Ville" name="_Ville[]" style="width: 50%;" maxlength="20" required>

                <label for="Tel" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Téléphone</label>
                <label for="Fax" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Fax</label>
                <input class="input" type="tel" id="Tel" name="_Tel[]" style="width: calc(50% - 10px);margin-right: 10px" maxlength="20" required>
                <input class="input" type="tel" id="Fax" name="_Fax[]" style="width: 50%;" maxlength="20" required>

                <label for="Site" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Site web</label>
                <input class="input" type="url" id="Site" name="_Site[]" maxlength="45" required>
                <!----------------------------------------------------------------------------------------------------------------------------------------------->
                <label style="margin: 10px 0;text-transform: uppercase;font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Responsable</label>
                <label for="Resp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Nom</label>
                <label for="RespPrenom" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Prénom</label>
                <input class="input" type="text" id="Resp" name="_Resp[]" style="width: calc(50% - 10px);margin-right: 10px" maxlength="45" required>
                <input class="input" type="text" id="RespPrenom" name="_RespPrenom[]" style="width: 50%;" maxlength="45" required>

                <label for="TelResp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Téléphone</label>
                <label for="MailResp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Email</label>
                <input class="input" type="tel" id="TelResp" name="_TelResp[]" style="width: calc(50% - 10px);margin-right: 10px" maxlength="20" required>
                <input class="input" type="email" id="MailResp" name="_MailResp[]" style="width: 50%;" maxlength="45" required>
                <!----------------------------------------------------------------------------------------------------------------------------------------------->
                <label style="margin: 10px 0;text-transform: uppercase;font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Société</label>
                <label for="TypeSoc" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Type d'entreprise</label>
                <label for="RespPrenom" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Taille de la socété</label>
                <select class="input" id="TypeSoc" name="_TypeSoc[]" style="width: calc(50% - 10px);margin-right: 10px" required>
                    <option value="Start Up">Start Up</option>
                    <option value="TPE PME">TPE PME</option>
                    <option value="Groupe">Groupe</option>
                    <option value="Groupe Multinational">Groupe Multinational</option>
                    <option value="Institution Publique">Institution Publique</option>
                    <option value="ONG Association">ONG Association</option>
                    <option value="Ecole Centre de formation">Ecole Centre de formation</option>
                </select>
                <select class="input" id="Taille" name="_Taille[]" style="width: 50%;" required>
                    <option value="Moins de 10 salariés">Moins de 10 salariés</option>
                    <option value="Moins de 100 salariés">Moins de 100 salariés</option>
                    <option value="Plus de 100salariés">Plus de 100 salariés</option>
                </select>

                <label for="TelResp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Secteur d"activité</label>
                <select class="input" id="Secteur" name="_Secteur[]" style="width: 50%;" required>
                    <option value="Primaire">Primaire</option>
                    <option value="Secondaire">Secondaire</option>
                    <option value="Tertiaire">Tertiaire</option>
                    <option value="Quaternaire">Quaternaire</option>

                </select>

                <input type="hidden" class="form-control" id="Geocode" name="_Geocode[]" required>

            </div>
        </div>

        <form id="formTier" action="{{ path('tieradded') }}" onsubmit="document.getElementById('submittier').disabled = true;ShowWaiter();" method="post" enctype="multipart/form-data">
            <div class="NavBarTier col-xs-12" >
                <button class="col-xs-12 active" onclick="NaviguerOnglet('PopUpAddTierOnglet','InformationTierObligatoire',this);">Informations Générales</button>
                {# L'ONGET DOCUMENTS NE SERA PAS UTILISE POUR LE MOMENT
                    <button class="col-xs-6" type="button" onclick="NaviguerOnglet('PopUpAddTierOnglet','InformationComp',this);">Documents/Infos</button>
                 #}
            </div>
            <div id="PopUpAddTierOnglet">
            <div id="InformationTierObligatoire" class="div_form" style="display: inline-table;" >
                {# JE RECUPERE CETTE SECTION EN TITRE DE POPUP PLUS HAUT
                    <label style="text-transform: uppercase;font: 16px Roboto;color: rgb(75, 75, 75);font-weight: bold;text-align: left;" class="col-xs-12">Informations générales</label>
                #}
                <label style="text-transform: uppercase;font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Raison sociale</label>
                <input type="text" class="input" id="RaisonSoc" name="_RaisonSoc" maxlength="45" required>
                <input type="text" style="visibility: hidden" class="input" id="SIREN" name="_SIREN" pattern=".{9}" maxlength="9" required>
                <div class="col-xs-6 input-colonne">


                    <label for="Logo" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Importer un logo</label>
                    <label style="display: flex;float: left;" for="Logo">
                        <img id="Logoimg" style="border: 1px solid rgb(230, 230, 230);background-image: -moz-linear-gradient( 90deg, rgb(215,215,215) 0%, rgb(255,255,255) 100%);background-image: -webkit-linear-gradient( 90deg, rgb(215,215,215) 0%, rgb(255,255,255) 100%);background-image: -ms-linear-gradient( 90deg, rgb(215,215,215) 0%, rgb(255,255,255) 100%);width: 100px;height: 90px;" src="" onclick="this.src='{{ asset('image/wait_x300.gif') }}'" />
                    </label>
                    <input onchange="readURL(this,'Logoimg');"  accept="image/*" type="file" class="input" id="Logo" name="_Logo" style="display: none">
                </div>

                <div class="col-xs-6 input-colonne">





                    <label for="Logo" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Importer un fond'écran</label>
                    <label style="float: left;" for="image">
                        <img id="backimg" style="border: 1px solid rgb(230, 230, 230);background-image: -moz-linear-gradient( 90deg, rgb(215,215,215) 0%, rgb(255,255,255) 100%);background-image: -webkit-linear-gradient( 90deg, rgb(215,215,215) 0%, rgb(255,255,255) 100%);background-image: -ms-linear-gradient( 90deg, rgb(215,215,215) 0%, rgb(255,255,255) 100%);width: 255px;height: 90px;" src="" onclick="this.src='{{ asset('image/wait_x300.gif') }}'" />
                    </label>
                    <input onchange="readURL(this,'backimg');" accept="image/*" type="file" class="input" id="image" name="_image" style="display: none">
                </div>

                <input  type="hidden" id="EcoleBool" name="_Ecole">


                <div id="adressecontainer">
                    <div id="div_adresse" name="ajouterAdresse" style="border-bottom: 10px;display: inline-block;">
                        <button class="toggle" type="button" data-toggle="collapse" data-target="#demo" style="display: none;"></button>
                        <button class="toggle" type="button" onclick="supprimerAdresse(this)" style="display: none;">-</button>
                        <div id="demo" class="collapse in">
                            <label style="margin: 10px 0;text-transform: uppercase;font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Adresse Principale</label>
                            <label for="Adresse" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Siret</label>
                            <input placeholder="Siret" class="input" onChange="VerifierSiret(this)" type="text" id="SIRETP" name="_SIRET[]" pattern=".{14}" maxlength="14" required>

                            {#<button id="P"  class="blue" type="button" onclick="VerifierSiret(this)">Vérifier si la société existe</button>#}

                            <label for="Adresse" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Rue</label>
                            <input class="input" type="text" id="RueP" name="_Adresse[]" maxlength="45" required>

                            <label for="CodeP" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Code postal</label>
                            <label for="Ville" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Ville</label>
                            <input class="input" type="text" id="CodePP" name="_CodeP[]" style="width: calc(50% - 10px); margin-right: 10px" maxlength="10" required>
                            <input class="input" type="text" id="VilleP" name="_Ville[]" style="width: 50%;" maxlength="20" required>

                            <label for="Tel" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Téléphone</label>
                            <label for="Fax" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Fax</label>
                            <input class="input" type="tel" id="TelP" name="_Tel[]" style="width: calc(50% - 10px);margin-right: 10px" maxlength="20" required>
                            <input class="input" type="tel" id="FaxP" name="_Fax[]" style="width: 50%;" maxlength="20" required>

                            <label for="Site" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Site web</label>
                            <input class="input" type="url" id="SiteP" name="_Site[]" maxlength="45" required>
                            <!----------------------------------------------------------------------------------------------------------------------------------------------->
                            <label style="margin: 10px 0;text-transform: uppercase;font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Responsable</label>
                            <label for="Resp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Nom</label>
                            <label for="RespPrenom" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Prénom</label>
                            <input class="input" type="text" id="RespP" name="_Resp[]" style="width: calc(50% - 10px);margin-right: 10px" maxlength="45" required>
                            <input class="input" type="text" id="RespPrenomP" name="_RespPrenom[]" style="width: 50%;" maxlength="45" required>

                            <label for="TelResp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Téléphone</label>
                            <label for="MailResp" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Email</label>
                            <input class="input" type="tel" id="TelRespP" name="_TelResp[]" style="width: calc(50% - 10px);margin-right: 10px" maxlength="20" required>
                            <input class="input" type="email" id="MailRespP" name="_MailResp[]" style="width: 50%;" maxlength="45" required>
                            <!----------------------------------------------------------------------------------------------------------------------------------------------->
                            <div id="InfoAddsociete">
                            <label style="margin: 10px 0;text-transform: uppercase;font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Société </label>
                            <label for="TypeSoc" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Type d'entreprise</label>
                            <label for="Taille" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-6">Taille de la socété</label>
                            <select class="input" id="TypeSocP" name="_TypeSoc[]" style="width: calc(50% - 10px);margin-right: 10px" required>
                                <option value="Start Up">Start Up</option>
                                <option value="TPE PME">TPE PME</option>
                                <option value="Groupe">Groupe</option>
                                <option value="Groupe Multinational">Groupe Multinational</option>
                                <option value="Institution Publique">Institution Publique</option>
                                <option value="ONG Association">ONG Association</option>
                                <option value="Ecole Centre de formation">Ecole Centre de formation</option>
                            </select>
                            <select class="input" id="TailleP" name="_Taille[]" style="width: 50%;" required>
                                <option value="Moins de 10 salariés">Moins de 10 salariés</option>
                                <option value="Moins de 100 salariés">Moins de 100 salariés</option>
                                <option value="Plus de 100salariés">Plus de 100 salariés</option>
                            </select>

                            <label for="Secteur" style="font: 18px Roboto;color: rgb(75, 75, 75);text-align: left;" class="col-xs-12">Secteur d"activité</label>
                            <select class="input" id="SecteurP" name="_Secteur[]" style="width: 50%;" required>
                                <option value="Primaire">Primaire</option>
                                <option value="Secondaire">Secondaire</option>
                                <option value="Tertiaire">Tertiaire</option>
                                <option value="Quaternaire">Quaternaire</option>
                            </select>
                            </div>
                            <!----------------------------------------------------------------------------------------------------------------------------------------------->
                            <input type="hidden" class="form-control" id="Geocode" name="_Geocode[]" required>

                        </div>
                    </div>
                </div>
                <button type="button" class="col-xs-12" style="background-color: rgb(215,215,215);height: 40px;border: none;" onclick="dupliqueradresse()">
                    Ajouter une adresse
                </button>
            </div>
            <div id="InformationComp" class="div_form" style="display: inline-table;position: absolute;visibility: hidden;" >
                <label for="Axe" style="text-transform: uppercase;font: 16px Roboto;color: rgb(75, 75, 75);font-weight: bold;text-align: left;" class="col-xs-6">Axe stratégique de développement : </label>
                <select class="input" id="Axe" name="_Axe" style="width: 50%;">
                    <option value="Internationanalisation">Internationanalisation</option>
                    <option value="Responsabilité Sociétale">Responsabilité Sociétale</option>
                    <option value="Environnementale">Environnementale</option>
                    <option value="Optimisation productivité">Optimisation productivité</option>
                    <option value="Innovation">Innovation</option>
                </select>
                <label for="Avantages" style="text-transform: uppercase;font: 16px Roboto;color: rgb(75, 75, 75);font-weight: bold;text-align: left;" class="col-xs-6">Avantages : </label>
                <select class="input" id="Avantages" name="_Avantages" style="width: 50%;">
                    <option value="Ticket resto">Ticket resto</option>
                    <option value="Commité entreprise">Commité entreprise</option>
                    <option value="Matériel fct.">Matériel Fct.</option>
                    <option value="Véhicule fct, Carte essence, Télépéage">Véhicule fct, Carte essence, Télépéage</option>
                    <option value="Primes participation/interessement">Primes participation/interessement</option>
                </select>

            </div>
            </div>
            <div class="div_button">
                <input type="submit" style="display: none">

                <button id="submittier" class="blue" type="button" onclick="envoyeradresses()">Envoyer</button>

            </div>
        </form>
    </div>

</div>

<div id="addsuperuser" class="popup col-xs-3">
    <div onclick="document.getElementById('submituser').click();hide(this)" class="close"></div>
    <div class="col-xs-offset-3 col-xs-6 formContainer">
        <span class="glyphicon glyphicon-remove" aria-hidden="true" style="float:right; height:40px; font-size:20px"onclick="this.parentElement.previousElementSibling.click();"> </span>
        <form id="formadduser" action="{{ path("user_added") }}" onsubmit="document.getElementById('submituser').disabled=true;ShowWaiter();" method="post" enctype="multipart/form-data">

            <div class="div_form"  style="display: inline-table;" >
                <div class="col-xs-6 input-colonne">
                    <input type="text" class="input" id="Username" name="_Username" placeholder="Username" maxlength="45" required>

                    <input type="email" class="input " id="mail" name="_mail" placeholder="Email" maxlength="45" required>

                    <select class="input" title="" name="_role">
                        <option value="ROLE_SUPER_ADMIN">Super Administrateur</option>
                    </select>
                </div>
                <div class="col-xs-6">
                    <select class="input " style="width: 25%; margin-right: 10px" title="" name="civilite">
                        <option value="Monsieur">Mr.</option>
                        <option value="Madame">Mme.</option>
                    </select>

                    <input type="text" class="input" style="width: calc(75% - 10px);" id="Prenom" name="_Prenom" placeholder="Prénom" maxlength="20" required>
                    <input type="text" class="input" id="Nom" name="_Nom" placeholder="Nom" maxlength="20" required>

                    <input type="tel" class="input " id="Tel" name="_Tel" placeholder="Tel" maxlength="20" required>
                </div>


            </div>
            <div class="div_button">
                <input  id="submituser" class="blue" type="submit" value="envoyer">
            </div>
        </form>
    </div>

</div>
<div id="addLicenceDef" class="popup col-xs-3">
    <div onclick="document.getElementById('submitLicence').click();hide(this)" class="close"></div>
    <div class="col-xs-offset-3 col-xs-6 formContainer" >
        <span class="glyphicon glyphicon-remove" aria-hidden="true" style="float:right; height:40px; font-size:20px"onclick="this.parentElement.previousElementSibling.click();"> </span>
        <form class="formulaire" id="formLicence" action="{{ path("metier_user_licenceadded") }}" onsubmit="document.getElementById('submitlicencedef').disabled=true;ShowWaiter();" method="post">

            <div class="div_form" style="display: inline-table;" >
                <div class="col-xs-6 input-colonne">
                    <input placeholder="Libellé" class="input" type="text" id="Libelle" name="_Libelle" maxlength="255" required >

                    <input class="input" type="number"  min="1" max="99999" placeholder="Durée" id="Duree" name="_Duree" required maxlength="11" >
                </div>
                <div class="col-xs-6">
                    <input class="input" type="number"  min="1" max="99999999" placeholder="Maximum d'apprenant" id="maxapp" name="_maxapp" required maxlength="11">

                    <input class="input" type="number"  min="1" max="99999999" placeholder="Maximum de mission" id="maxmiss" name="_maxmiss" required maxlength="11">
                </div>
                <textarea form="formLicence" placeholder="Description" class="input" maxlength="255" id="Description" name="_Description" style="resize: none; height: 100px;display: inline-flex"></textarea>



            </div>
            <div class="div_button">
                <input class="blue" id="submitLicence" name="submitLicenceDef" type="submit" value="envoyer">

            </div>
        </form>
    </div>
</div>

<div id="import" class="popup col-xs-3">
    <div onclick="document.getElementById('submitimport').click();hide(this)" class="close"></div>
    <div class="col-xs-offset-1 col-xs-9 formContainer">
        <span class="glyphicon glyphicon-remove" aria-hidden="true" style="float:right; height:40px; font-size:20px"onclick="this.parentElement.previousElementSibling.click();"> </span>
        <form id="formImport" action="{{ path('import') }}" onsubmit="document.getElementById('submitimport').disabled=true;ShowWaiter();" method="post" enctype="multipart/form-data">
            <div class="div_form">

                <select onchange="disabling(this)" title="Type d'import" name="Import">
                    <option value="0">Apprenants</option>
                    <option value="1">Sociétés</option>
                    <option value="2">Missions</option>

                </select>
                <select title="Etablissement" name="Etablissement">
                    {% if ecoles is defined %}
                    {% for etab in ecoles %}
                        <option value="{{ etab.getId }}">{{ etab.getSiret }}</option>
                    {% endfor %}
                    {% endif %}
                </select>
                <br>
                <label title="CSV" for="CSV"><img onclick="this.src='{{ asset('image/wait_x300.gif') }}'; " id="backimg" style="height: 150px;width: 150px"  src="{{ asset('image/upload-arrow.png') }}"/></label>
                <input accept=".xlsx" type="file" class="input" id="CSV" name="_CSV" required>

            </div>
            <div class="div_button">
                <input id ="submitimport" class="blue" type="submit" value="envoyer">
            </div>
        </form>
    </div>

</div>

<div class="container">
{% block TopBar %}
    <div class="row" style="height: 32px; background: #2975cb;">
        <div class="col-xs-1" style="height: 100%;" >
            <a href="{{ path('metier_user_login') }}" ><img src="{{ asset('image/Logo_Hub_3e.png') }}" style="height: 100%" >   </a>
        </div>
        <div class="input-group col-xs-1" style="margin-left: 10px;border: 0;padding: 4px;height: 21px;float: left;">
            <button onclick="show('addtier',1);ecole();" type="button" class="glyphicon glyphicon-plus input-group-addon topbaradd"
                    ></button>
            <button id="ecoletop" class="BtnText"  style="color:white;white-space: nowrap;overflow: hidden; ">{% if ecoles is defined %}{{ ecoles|length }} {% endif %}Ecoles</button>
        </div>
         <div class="input-group col-xs-1" style=" margin-left: 10px;border: 0;padding: 4px;height: 21px;float: left;">
             <button onclick="show('addtier',0)" type="button" class="glyphicon glyphicon-plus input-group-addon topbaradd"
                     ></button>

             <button id="societetop" style="color:white;white-space: nowrap;overflow: hidden; ">{% if societes is defined %}{{ societes|length }} {% endif %}Sociétés </button>


         </div>
         <div class="input-group col-xs-1" style=" margin-left: 10px;border: 0;padding: 4px;height: 21px;float: left;">
             <button onclick="show('addLicenceDef')" type="button" class="glyphicon glyphicon-plus input-group-addon topbaradd"
                    ></button>


             <button id="licencetop" style="color:white;white-space: nowrap;overflow: hidden; ">{% if AllLicences is defined %}{{ AllLicences|length }}{% endif %} Licences</button>
         </div>
         <div class="input-group col-xs-1" style=" margin-left: 10px;border: 0;padding: 4px;height: 21px;float: left;">
             <button onclick="show('addsuperuser')" type="button" class="glyphicon glyphicon-plus input-group-addon topbaradd"
                     ></button>


             <button id="usertop" style="color:white;white-space: nowrap;overflow: hidden; ">{% if users is defined %}{{ users|length }}{% endif %} Utilisateurs</button>
         </div>
        <div class="input-group col-xs-1" style=" margin-left: 10px;border: 0;padding: 4px;height: 21px;float: left;">
            <button onclick="show('import')" style="color:white;white-space: nowrap;overflow: hidden;padding: 0;background: #1654b7 ;border: none;margin: 0 ;height: 21px;width: 100%;font: 14px Roboto; ">Importer</button>
        </div>
        <div class="input-group col-xs-1" style=" margin-left: 10px;border: 0;padding: 4px;height: 21px;float: left;">

            <button onclick="document.getElementById('iframe').src='{{ path('afficher_import') }}'"
                    style="color:white;white-space: nowrap;overflow: hidden;padding: 0;background: #1654b7 ;border: none;margin: 0 ;height: 21px;width: 100%;font: 14px Roboto; ">SAS Admissions</button>
        </div>





        <div class="col-xs-1 btn-group" style="height: 20px;float: right;margin-right: 40px">
            <button type="button" class="btn btn-default dropdown-toggle"
                    data-toggle="dropdown" aria-haspopup="true"
                    aria-expanded="false"
                    style="padding:0;width: 100%; height: 20px; border-radius: 0; background: none; border: 0;color: white">
                {% if image %}
                    <img  src="data:image/jpg;base64,{{image}}" style="border-radius:50%; width:32px; height:32px" ><span style="width:12px;height:12px;border-radius: 50%;left: 32px;background:#cc0000;color:white;font:10px Roboto;position:absolute;">{% if messages is defined %}
                        {{ messages }}
                    {% endif %}</span>
                {% elseif app.user.getCivilite == 'Mme' or app.user.getCivilite == 'Madame' or app.user.getCivilite == 'Mademoiselle' %}
                        <img  src="{{ asset('image/femme.jpg') }}" style="border-radius:50%; width:32px; height:32px" ><span style="width:12px;height:12px;border-radius: 50%;left: 32px;background:#cc0000;color:white;font:10px Roboto;position:absolute;">{% if messages is defined %}
                        {{ messages }}
                    {% endif %}</span>
                {% else %}
                    <img  src="{{ asset('image/homme.jpg') }}" style="border-radius:50%; width:32px; height:32px" ><span style="width:12px;height:12px;border-radius: 50%;left: 32px;background:#cc0000;color:white;font:10px Roboto;position:absolute;">{% if messages is defined %}
                        {{ messages }}
                    {% endif %}</span>
                {% endif %}
                {{ app.user.username }} <span class="glyphicon glyphicon-triangle-bottom"
                                              aria-hidden="true"></span>
            </button>
            <ul id="profil" class="dropdown-menu" aria-labelledby="dropdownMenu1" style="color:white;background: #2975cb;">
                <li><button onclick="postiframe('{{ path('afficher_profil') }}')" style="background: transparent;border:transparent;width:100%">PROFIL</button></li>
                <li><button onclick="document.getElementById('iframe').src='{{ path('afficher_messagerie') }}';" style="background: transparent;border:transparent;width:100%">MESSAGERIE</button></li>
                <li><button onclick="document.getElementById('iframe').src='{{ path('afficher_rendezvous') }}';" style="background: transparent;border:transparent;width:100%">RENDEZ-VOUS</button></li>
                <li><a onclick="sessionStorage.clear()" href="{{ path('logout') }}" style="color:white;background: #2975cb;"><button style="background: transparent;border:transparent;width:100% ">DECONNEXION</button> </a></li>
            </ul>


        </div>

    </div>


{% endblock %}
    <div class="row" style="height: 100%">
        {% block LeftBar %}
            <div class="col-xs-2">

                <select title="" id="leftselect" name="myddl" class="btn btn-default dropdown-toggle">
                    <option value="ecole">Voir Ecoles</option>
                    <option value="societe">Voir Sociétés</option>
                    <option value="licence">Voir Licences</option>
                    <option value="user">Voir Utilisateurs</option>
                    <option value="apprenants">Voir Apprenants</option>
                    <option value="mission">Voir Missions</option>
                    <option value="mission_propose">Voir Missions proposées</option>
                    <option value="QCM">Gestion QCM</option>
                    <option value="modele">Gestion Modèles</option>
                </select>

                <div id="ecole" class="list-group col-xs-2 leftbar">
                    {% if ecoles is defined %}
                        {% for e in ecoles %}
                            <button onclick="postiframe('{{ path('affiche_etab',{'id': e.getId} ) }}',{{ e.getId }},this);" id="etablissement{{ e.getId }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{ e.getTier.getRaisonSoc }},{{ e.siret }},{{ e.adresse }},{{ e.codepostal }},{{ e.ville }}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part" title="{{e.getTier.getRaisonSoc}}">{{e.getTier.getRaisonSoc}}</div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">
                                    <div class="col-xs-9 part" title="{{ e.getVille }}">{{ e.getVille }}</div>
                                    {% if e.getActive %}
                                        <div class="col-xs-1 active" id="activeEcole{{ e.getId }}"></div>
                                    {% else %}
                                        <div class="col-xs-1 inactive" id="activeEcole{{ e.getId }}"></div>
                                    {% endif %}
                            </div>
                            </button>
                        {% endfor %}
                    {% endif %}
                </div>
                <div id="societe" class="list-group col-xs-2 leftbar"
                     style="visibility: hidden;">
                    {% if societes is defined %}
                        {% for s in societes %}
                            <button onclick="postiframe('{{ path('affiche_etab',{'id': s.getId }) }}',{{ s.getId }},this)" id="etablissement{{ s.getId }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{ s.getTier.getRaisonSoc }},{{ s.siret }},{{ s.adresse }},{{ s.codepostal }},{{ s.ville }}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part" title="{{s.getTier.getRaisonSoc}}">{{s.getTier.getRaisonSoc}}</div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">
                                    <div class="col-xs-9 part" title="{{ s.getVille }}">{{ s.getVille }}</div>
                                    {% if s.getActive %}
                                        <div class="col-xs-1 active" id="activeSociete{{ s.getId }}"></div>
                                    {% else %}
                                        <div class="col-xs-1 inactive" id="activeSociete{{ s.getId }}"></div>
                                    {% endif %}
                                </div>
                            </button>
                        {% endfor %}
                    {% endif %}

                </div>
                <div id="licence" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if AllLicences is defined %}
                        {% for lic in AllLicences %}
                            <button onclick="postiframe('{{ path('admin_afficheLicence',{'id': lic.getId} ) }}')" id="licence{{ lic.getId }}" type="button" class="list-group-item butonLigne">
                                <div class="col-xs-12 part" title="{{lic.getLibelle}}">{{lic.getLibelle}}</div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">
                                    <div class="col-xs-9 part" title="{{ lic.getDuree }}">{{lic.getDuree }}</div>
                                </div>
                            </button>
                        {% endfor %}
                    {% endif %}

                </div>
                <div id="user" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if users is defined %}
                        {% for u in users %}
                            <button onclick="postiframe('{{ path('metier_user_afficheUser',{'id': u.getId }) }}',this)" id="user{{ u.getId }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{ u.nom }},{{ u.getUsername }},{{ u.prenom }},{{ u.email }},{% if u.tier %}{{ u.tier.siren }}{% elseif u.etablissement %}{{ u.etablissement.siret }}{% endif %}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part" title="{{u.getUsername}}">{{u.getUsername}}</div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">

                                    <div class="col-xs-9 part" title="{{u.getEmail}}">{{ u.getEmail }}</div>
                                    {% if not u.isExpired %}
                                        <div class="col-xs-1 active" id="activeUser{{ u.getId }}"></div>
                                    {% else %}
                                        <div class="col-xs-1 inactive" id="activeUser{{ u.getId }}"></div>
                                    {% endif %}

                                </div>
                            </button>
                        {% endfor %}
                    {% endif %}
                </div>
                <div id="apprenants" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if apprenants is defined %}
                        {% for u in apprenants %}
                            <button onclick="postiframe('{{ path('metier_user_afficheUser',{'id': u.getId }) }}',this)" id="user{{ u.getId }}" type="button" class="list-group-item butonLigne">



                                {% if  u.getPlace!=1   %}

                                    {% set place=2 %}

                                {% else %}
                                    {% set place=1 %}
                                {% endif %}

                                {% if  u.getInfo.getHandicape==1   %}

                                    {% set Handicape=3 %}
                                {% else %}
                                    {% set Handicape=30 %}
                                {% endif %}

                                {% if  u.getInfo.getEntrepreneur==1   %}

                                    {% set Entrepreneur=4 %}
                                {% else %}
                                    {% set Entrepreneur=40 %}
                                {% endif %}

                                {% if  u.getInfo.getPermis==1   %}

                                    {% set Permis=5 %}
                                {% else %}
                                    {% set Permis=50 %}
                                {% endif %}

                                {% if  u.getInfo.getVehicule==1   %}

                                    {% set Vehicule=6 %}
                                {% else %}
                                    {% set Vehicule=60 %}
                                {% endif %}



                                <div name="Recherche" style="display: none;">{{ place }},{{ Handicape }},{{ Entrepreneur }},{{ Permis }},{{ Vehicule }},{{ u.nom }},{{ u.getUsername }},{{ u.prenom }},{{ u.email }},{% if u.info %}{{ u.info.adresse }},{{ u.info.cp }}{% endif %},{% if u.etablissement %}{{ u.etablissement.siret }}{% endif %}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part" title="{{u.getUsername}}">{{u.getUsername}}</div>

                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">

                                    <div class="col-xs-9 part" title="{{u.getEmail}}">{{ u.getEmail }}</div>
                                    <label class="StatutApp">
                                        {% if u.getPlace == 1 %}
                                            Placé
                                        {% else %}
                                            A placer

                                        {% endif %}
                                    </label>



                                    {% if u.info %}
                                    {% if u.info.profilcomplet == 3 %}
                                        <div class="col-xs-1 active" id="activeUser{{ u.getId }}"></div>
                                    {% elseif u.info.profilcomplet == 2 %}
                                        <div class="col-xs-1 inactive" id="activeUser{{ u.getId }}"></div>
                                    {% elseif u.info.profilcomplet == 1 %}
                                        <div class="col-xs-1" style="background: #2A76CC;height:9px;border-radius: 100%;margin: 3px 0;width: 9px;float: right;" id="activeUser{{ u.getId }}"></div>
                                    {% else %}
                                        <div class="col-xs-1" style="background: #c77405;height:9px;border-radius: 100%;margin: 3px 0;width: 9px;float: right;" id="activeUser{{ u.getId }}"></div>
                                    {% endif %}
                                    {% endif %}
                                </div>

                            </button>
                        {% endfor %}
                    {% endif %}
                </div>
                <div id="mission" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if missions is defined %}
                        {% for m in missions %}
                            <button onclick="postiframe('{{ path('admin_afficheMission',{'id': m.getId ,'idFor': "-1" }) }}',this)" id="mission{{ m.getId }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{ m.statut }},{{ m.intitule }},{{ m.profil }},{{ m.typecontrat }},{{ m.codemission }},{{ m.domaine }},{{ m.etablissement.tier.raisonsoc }},{{ m.etablissement.siret }},{{ m.etablissement.adresse }},{{ m.etablissement.codepostal }},{{ m.etablissement.ville }}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part" title="{{m.getIntitule}}">
                                    {{m.getIntitule}}
                                    <label class="StatutMission">
                                        {% if m.statut == 1 %}
                                            Prive
                                        {% elseif m.statut == 2 %}
                                            Semi Public
                                        {% elseif m.statut == 3 %}
                                            Public
                                        {% endif %}
                                    </label>
                                </div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">

                                    <div class="col-xs-9 part" style="color:#2975cb" title="{{m.getEtablissement.getTier.getRaisonsoc}}">
                                        {{ m.getEtablissement.getTier.getRaisonsoc}}
                                        <span style="color:#7F7F7F;margin-right: 30px;">{{ m.getEtablissement.getVille}}</span>
                                    </div>



                                    {% if not m.getSuspendu %}
                                        <div class="col-xs-1 active" id="active{{ m.getId }}"></div>
                                    {% else %}
                                        <div class="col-xs-1 inactive" id="active{{ m.getId }}"></div>
                                    {% endif %}

                                </div>
                            </button>
                        {% endfor %}
                    {% endif %}

                </div>
                <div id="mission_propose" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if DiffusionEnSuspend is defined %}
                        {% for diff in DiffusionEnSuspend %}
                            {% set m = diff.mission %}
                            <button onclick="postiframe('{{ path('Afficher_Mission_Propose',{'id':m.id}) }}')" id="mission_propose{{ m.getId }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{ m.intitule }},{{ m.profil }},{{ m.typecontrat }},{{ m.codemission }},{{ m.domaine }},{{ m.etablissement.tier.raisonsoc }},{{ m.etablissement.siret }},{{ m.etablissement.adresse }},{{ m.etablissement.codepostal }},{{ m.etablissement.ville }}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part" title="{{m.getIntitule}}">{{m.getIntitule}}</div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">

                                    <div class="col-xs-9 part" style="color:#2975cb" title="{{m.getEtablissement.getTier.getRaisonsoc}}">
                                        {{ m.getEtablissement.getTier.getRaisonsoc}}
                                        <span style="color:#7F7F7F">{{ m.getEtablissement.getVille}}</span>
                                    </div>

                                    {% if not m.getSuspendu %}
                                        <div class="col-xs-1 active" id="active{{ m.getId }}"></div>
                                    {% else %}
                                        <div class="col-xs-1 inactive" id="active{{ m.getId }}"></div>
                                    {% endif %}

                                </div>
                            </button>
                        {% endfor %}
                    {% endif %}

                </div>
                <div id="QCM" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if qcms is defined %}
                        {% for qcm in qcms %}
                            <button onclick="postiframe('{{ path('loadgestionQCM',{'id': qcm.getId} ) }}')" id="qcm{{ qcm.getId }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{qcm.getNom}}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part">{{qcm.getNom}}</div>
                                <div class="col-xs-12 part"
                                     style="height: 31px; text-align: left;">
                                    <div class="col-xs-9 part"></div>
                                    <span class="badge">New</span>
                                    <div class="col-xs-1 online"></div>
                                </div>
                            </button>
                        {% endfor %}
                    {% endif %}

                </div>
                <div id="modele" class="list-group col-xs-2 leftbar" style="visibility: hidden;">
                    {% if modeles is defined %}
                        {% for modele in modeles %}
                            <button onclick="postiframe('{{ path('creeNewModele',{'id': modele} ) }}')" id="{{ modele }}" type="button" class="list-group-item butonLigne">
                                <div name="Recherche" style="display: none;">{{modele}}</div>
                                <div style="display: none;"></div>
                                <div class="col-xs-12 part">{{modele}}</div>
                            </button>
                        {% endfor %}
                    {% endif %}

                </div>
            </div>
        {% endblock %}

        <div class="col-xs-10" style="height: 100%" >

            <div class="row" style="height: 40px; margin: 0; background: #3988d7;">

                <div class="input-group col-xs-offset-1 col-xs-6" style="margin-top: 5px; float: left;">
                    <span class="glyphicon glyphicon-search input-group-addon topbaradd"
                          id="basic-addon1" style="width: 27px;height: 27px;padding: 7px"></span>
                    <input onkeyup="search(this.value)" type="text" class="recherche" aria-describedby="basic-addon1"
                           style="height: 27px;">
                </div>

                <div id="divfiltreMission"  class="col-xs-offset-3 col-xs-1 btn-group" style="height: 20px;visibility: hidden;">
                    {# FILTRE Caché#}
                    <button type="button" class="btn btn-default dropdown-toggle"
                            data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"
                            style="font:17px Roboto; width: 100%; height: 20px; border-radius: 0; background: none; border: 0;color: white">
                        Filtres <span class="glyphicon glyphicon-menu-down"
                                      aria-hidden="true"></span>
                    </button>
                    <ul id="filtre" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <li data-rec="0">Toutes les mission</li>
                        <li data-rec="1">Missions privées</li>
                        <li data-rec="2">Missions semi-public</li>
                        <li data-rec="3">Missions publiques</li>
                    </ul>
                </div>
                <div id="divfiltreApp" class="col-xs-offset-3 col-xs-1 btn-group" style="height: 20px;margin-top: -20px;visibility: hidden;">
                    {# FILTRE Caché#}
                    <button type="button" class="btn btn-default dropdown-toggle"
                            data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false"
                            style="font:17px Roboto; width: 100%; height: 20px; border-radius: 0; background: none; border: 0;color: white">
                        Filtres <span class="glyphicon glyphicon-menu-down"
                                      aria-hidden="true"></span>
                    </button>
                    <ul id="filtreApp" class="dropdown-menu" aria-labelledby="dropdownMenu1">
                        <li data-rec="0">Tous les apprenants</li>
                        <li data-rec="1">Apprenants placés</li>
                        <li data-rec="2">Apprenants à placer</li>
                        <li data-rec="3">Handicapé</li>
                        <li data-rec="4">Entrepreneur</li>
                        <li data-rec="5">Permis</li>
                        <li data-rec="6">Véhiculé</li>






                    </ul>
                </div>
               <!-- <button id="ecoletop" style="white-space:nowrap;width:30px;height:30px;background:#cc0000;font:bold 10px Arial;border-radius:50%;border:none;color:#fff; ">
                    <span class="glyphicon glyphicon-envelope" aria-hidden="true" ></span></button>-->
            </div>

            {% block Content%}
                <iframe id="iframe" src="{{ path('afficher_profil') }}"></iframe>
            {% endblock %}
        </div>
    </div>

</div>

<script src="{{ asset('js/jquery-1.11.3.js') }}"></script>
<script src="{{ asset('js/bootstrap.min.js') }}"></script>
<script src="{{ asset('js/PopUp.js') }}"></script>
<script src="http://maps.googleapis.com/maps/api/js"></script>

<script language="JavaScript">
    var i = 1;
    function putbadged() {
        var iframe = sessionStorage.getItem('_Iframe');
        if(iframe)
        {
            document.getElementById("iframe").src = iframe;
        }
        document.getElementById("iframe").style.visibility = 'visible';
        {% if notifications is defined %}
        var notifs = JSON.parse('{{ notifications }}');
        var ecole =0;
        var societe = 0;
        var user = 0;
        for(var i = 0; i< notifs.length;i++)
        {
            var span = document.createElement("span");
            span.className = 'badge';
            span.innerHTML = 'New';
            if(notifs[i].type == 'Ecole')
            {
                ecole++;
                var active = document.getElementById("activeEcole"+ notifs[i].entite);
                if(active != null){active.parentNode.insertBefore(span,active);}

            }
            else if(notifs[i].type == 'Societe')
            {
                societe++;
                var active = document.getElementById("activeSociete"+ notifs[i].entite);
                if(active != null){active.parentNode.insertBefore(span,active);}

            }
            else if(notifs[i].type == 'Utilisateur')
            {
                user++;
                var active = document.getElementById("activeUser"+ notifs[i].entite);
                if(active != null){active.parentNode.insertBefore(span,active);}

            }
        }

        if(ecole > 0)
        {
            var spanecole = document.createElement("span");
            spanecole.className = 'badge';
            spanecole.className = spanecole.className + ' notifTopbar';
            spanecole.innerHTML = ecole;
            var buttonecole = document.getElementById("ecoletop");
            buttonecole.appendChild(spanecole);
        }
        if(societe >0)
        {var spansociete = document.createElement("span");
            spansociete.className = 'badge';
            spansociete.className = spansociete.className + ' notifTopbar';
            spansociete.innerHTML = societe;
            var buttonsociete = document.getElementById("societetop");
            buttonsociete.appendChild(spansociete);
        }
        if(user >0)
        {var spanuser = document.createElement("span");
            spanuser.className = 'badge';
            spanuser.className = spanuser.className + ' notifTopbar';
            spanuser.innerHTML = user;
            var buttonuser = document.getElementById("usertop");
            buttonuser.appendChild(spanuser);
        }
        {% endif %}
    }

    function ecole(){


       // document.getElementsByTagName('_TypeSoc[]').style.display='none';

        //alert('kanoun');

    }

    {#function modifierStatutMission(value,idmis) {
        ShowWaiter();
        var route = '{{ path('ModifStatutMission',{'id':"_idMission",'statut':"_value"}) }}';
        route = route.replace('_idMission', idmis);
        route = route.replace('_value', value);

        $.ajax({
            type: 'get',
            url: route,
            success: function(data) {
                DeleteWaiter();
                console.log(data);
            },
            error: function(data) {
                console.log(data);
            }
        });
    }#}

    function dupliqueradresse() {

        var dup = document.getElementById("div_adresse");
        var clone = dup.cloneNode(true);
        var toggle = clone.children[0];
        toggle.setAttribute("data-target","#Adresse" + i);
        toggle.innerHTML="Adresse " + i;

        var div = clone.children[2];
        div.setAttribute("id","Adresse" + i);
        clone.style.display = 'inline-block';

        div.children[2].id=div.children[2].id+i;
        //div.children[3].id=i;
        // if boutton ajouter +1
        div.children[4].id=div.children[4].id+i;
        div.children[5].id=div.children[5].id+i;
        div.children[7].id=div.children[7].id+i;
        div.children[8].id=div.children[8].id+i;
        div.children[11].id=div.children[11].id+i;
        div.children[12].id=div.children[12].id+i;
        div.children[14].id=div.children[14].id+i;
        div.children[18].id=div.children[18].id+i;
        div.children[19].id=div.children[19].id+i;
        div.children[22].id=div.children[22].id+i;
        div.children[23].id=div.children[23].id+i;
        div.children[27].id=div.children[27].id+i;
        div.children[28].id=div.children[28].id+i;
        div.children[30].id=div.children[30].id+i;

        document.getElementById("adressecontainer").appendChild(clone);
        var parentdiv = dup.parentNode;
        var close =dup.parentNode.parentNode;
        if(parentdiv.offsetHeight  > close.offsetHeight )
        {
            close.style.height = parentdiv.offsetHeight;
            clone.children[0].style.height = parentdiv.offsetHeight;
        }

        i++;
    }
    function submitAjaxForm(url,form){
        $.ajax({
            type: "POST",
            url: url,
            data: $("#"+form).serialize(),
            success: function(data)
            {
                if(data['status']==='success')
                {
                    $("#"+form+" input[type=submit]").click();
                    document.getElementById('submittier').disabled=false;
                }
                else if(data['status']==='exist')
                {
                    alert('un des sirets éxiste déjà');
                    document.getElementById('submittier').disabled=false;
                }
                else if(data['status']==='is_ecole')
                {
                    alert('Le siren indiqué appartient à une école!');
                    document.getElementById('submittier').disabled=false;
                }
                else
                {
                    alert('Une erreur s\'est produite sur le serveur');
                    document.getElementById('submittier').disabled=false;
                }
            }
        });
    }
    function envoyeradresses(){

        document.getElementById('submittier').disabled=true;
        var geocodes = document.getElementsByName('_Geocode[]');
        if(geocodes.length==1)
        {
            alert('Vous devez remplir au moins une adresse');
            document.getElementById('submittier').disabled=false;
        }
        for(var j = 1;j<geocodes.length;j++){
            var siret = document.getElementsByName('_SIRET[]')[j].value;
            var test = siret.substring(0, 9);
            document.getElementById('SIREN').value=test;

        }
        var result_input= [];
        for(var i = 1; i<geocodes.length;i++)
        {
            var address = document.getElementsByName('_Adresse[]')[i].value +' ' +document.getElementsByName('_Ville[]')[i].value + ' ' + document.getElementsByName('_CodeP[]')[i].value  ;
            var geocoder = new google.maps.Geocoder();
            geocoder.geocode({'address': address}, function (results, status) {



                if (status === google.maps.GeocoderStatus.OK) {
                    result_input.push(results[0].geometry.location);
                    if(result_input.length == geocodes.length - 1)
                    {
                        for(var y = 1; y< geocodes.length; y++)
                        {
                            geocodes[y].value = result_input[y - 1] ;
                        }
                        var check = '{{ path('tier_checkExist') }}';
                        submitAjaxForm(check,'formTier');
                    }
                } else {

                    alert('Pas de géocodage trouvé pour l\'adresse spécifiée');

                    document.getElementById('submittier').disabled=false;

                }
            });
        }
    }
    function readURL(input,baliseimg) {
        document.getElementById(baliseimg).src="{{ asset('image/wait_x300.gif') }}";
        if (input.files && input.files[0]) {
            var reader = new FileReader();
            reader.onload = function (e) {
                $('#'+ baliseimg)
                        .attr('src', e.target.result)
            };

            reader.readAsDataURL(input.files[0]);
        }

    }
    function supprimerAdresse(div){
        div.parentNode.parentNode.removeChild(div.parentNode);
    }
    function disabling(champ){
        if(champ.options[champ.selectedIndex].value ==0){champ.nextElementSibling.style.display = 'inline-block';}
        else{champ.nextElementSibling.style.display = 'none';}
    }
</script>

{% block JS %}
<script language="JavaScript">

    document.getElementById("leftselect").onchange = function(){
        var x = document.getElementById("leftselect").value;
        if(x=='mission'){
            document.getElementById('divfiltreApp').style.visibility= 'hidden';
            document.getElementById('divfiltreMission').style.visibility='visible';


        }else if(x=='apprenants'){
           document.getElementById('divfiltreMission').style.visibility= 'hidden';
            document.getElementById('divfiltreApp').style.visibility='visible';
        }else {

            document.getElementById('divfiltreMission').style.visibility= 'hidden';
            document.getElementById('divfiltreApp').style.visibility='hidden';
        }


        if(x=='QCM')
        {
            document.getElementById("iframe").src = '{{ path('loadgestionQCM') }}';
            sessionStorage.setItem('_Iframe','{{ path('loadgestionQCM') }}');
        }
        if(x=='modele')
        {
            document.getElementById("iframe").src = '{{ path('creeNewModele') }}';
            sessionStorage.setItem('_Iframe','{{ path('creeNewModele') }}');
        }
        document.getElementById('mission').style.visibility= 'hidden';
        document.getElementById('mission_propose').style.visibility= 'hidden';
        document.getElementById('ecole').style.visibility= 'hidden';
        document.getElementById('societe').style.visibility= 'hidden';
        document.getElementById('licence').style.visibility= 'hidden';
        document.getElementById('user').style.visibility= 'hidden';
        document.getElementById('apprenants').style.visibility= 'hidden';
        document.getElementById('QCM').style.visibility= 'hidden';
        document.getElementById('modele').style.visibility= 'hidden';
        document.getElementById(x).style.visibility='visible';
        sessionStorage.setItem('leftonglet',x);
    };

    function loading(){
        var onglet = sessionStorage.getItem('leftonglet');
        if(onglet)
        {
            $('#leftselect').find('option[value="' + onglet + '"]').prop('selected', true).change();
        }
    }

    function postiframe(url,id,button) {
        document.getElementById("iframe").src = url;
        /*var route = '{{path('adresses_tier',{'id':"_id" })}}';
        route = route.replace("_id", id);
        $.ajax({
            type: 'get',
            url: route,
            dataType: 'json',
            success: function(data){
                var filtre = document.getElementById("filtre");
                while (filtre.firstChild) {
                    filtre.removeChild(filtre.firstChild);
                }
                for (var i = 0; i < data.adresses.length; i++)
                {
                    var obj = JSON.parse(data.adresses[i]);

                    var li = document.createElement("li");

                    var a = document.createElement("a");
                    a.setAttribute('href',obj.id);
                    a.innerHTML = obj.adresse;

                    li.appendChild(a);

                    filtre.appendChild(li);
                }

            }
        });*/
        var elements = button.getElementsByClassName("badge");
        if(elements.length > 0)
        {
            elements[0].parentNode.removeChild(elements[0]);
        }
        sessionStorage.setItem('_Iframe',url);

    }

    function search(mot){
        var mots = mot.toUpperCase().trim().split(/ +/g);
        var Recherches = document.getElementsByName('Recherche');
        for(var i = 0; i < Recherches.length; i++)
        {
            var score = 0;
            Recherches[i].parentNode.style.display="block";
            var recherchermot = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g);
            for(var k = 0; k< recherchermot.length; k++)
            {
                for(var j = 0; j< mots.length;j++)
                {
                    if (stringWith(recherchermot[k], mots[j])) {
                        score++;
                    }
                }
            }
            if(score === 0 ){
                Recherches[i].parentNode.style.display="none";
                Recherches[i].nextElementSibling.innerHTML = score;
            }
            else {
                Recherches[i].nextElementSibling.innerHTML = score;
            }
        }
        SortDiv('ecole');
        SortDiv('societe');
        SortDiv('user');
        SortDiv('apprenants');
        SortDiv('mission');
    }

    function SortDiv(divId){
        var toSort = document.getElementById(divId).children;
        toSort = Array.prototype.slice.call(toSort, 0);

        toSort.sort(function(a, b) {
            var aord = +a.children[1].innerHTML;
            var bord = +b.children[1].innerHTML;
            // two elements never have the same ID hence this is sufficient:
            return (aord > bord) ? -1 : 1;
        });
        var parent = document.getElementById(divId);
        parent.innerHTML = "";

        for(var t = 0, l = toSort.length; t < l; t++) {
            parent.appendChild(toSort[t]);
        }
    }

    $('#filtre').find('li').on('click',function(){

        var Recherches = $('#mission').find('div[name="Recherche"]');
        for(var i = 0; i < Recherches.length; i++)
        {
            Recherches[i].parentNode.style.display="";
            var recherchermot = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g)[0];

            if(recherchermot != $(this).attr("data-rec") && $(this).attr("data-rec") != "0" ){
                Recherches[i].parentNode.style.display="none";
            }
        }
    })

    $('#filtreApp').find('li').on('click',function(){

        var Recherches = $('#apprenants').find('div[name="Recherche"]');
        for(var i = 0; i < Recherches.length; i++)
        {
            Recherches[i].parentNode.style.display="";
            var recherchermot = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g)[0];
            var rechercherHandicape = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g)[1];
            var rechercherEntrepreneur = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g)[2];
            var rechercherPermis = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g)[3];
            var rechercherVehicule = Recherches[i].innerHTML.toUpperCase().trim().split(/,+/g)[4];


           // alert('recheche mot '+recherchermot);
           // alert('data-rec '+$(this).attr("data-rec"));

            if(recherchermot != $(this).attr("data-rec") && $(this).attr("data-rec") != "0" ){
                if(rechercherHandicape != $(this).attr("data-rec") && $(this).attr("data-rec") != "0" ){
                    if(rechercherEntrepreneur != $(this).attr("data-rec") && $(this).attr("data-rec") != "0" ){
                        if(rechercherPermis != $(this).attr("data-rec") && $(this).attr("data-rec") != "0" ){
                            if(rechercherVehicule != $(this).attr("data-rec") && $(this).attr("data-rec") != "0" ){
                                Recherches[i].parentNode.style.display="none";
                            }else{
                                Recherches[i].parentNode.style.display="block";
                            }
                        }else{
                            Recherches[i].parentNode.style.display="block";
                        }
                    }else{
                        Recherches[i].parentNode.style.display="block";
                    }

                }else {
                    Recherches[i].parentNode.style.display="block";
                }
            }

            //alert('recheche mot '+rechercherHandicape);
            //alert('data-rec '+$(this).attr("data-rec"));

        }
    })

    function VerifierSiret(button){


        //var siret= button.previousElementSibling.value;
        var siret= button.value;
        var idCompliment=button.id.replace('SIRET','');
        var route = '{{ path('Siret_Verifier',{'siret':"_siret"}) }}';
        route = route.replace('_siret',siret);
        ShowWaiter();

       $.ajax({
            type: "POST",
            url: route,

            success: function(data)
            {

                 if(data['status']==='exist')
                {

                    document.getElementById('Rue'+idCompliment).value=data['rue'];
                    document.getElementById('CodeP'+idCompliment).value=data['codePostal'];
                    document.getElementById('Ville'+idCompliment).value=data['ville'];
                    document.getElementById('Tel'+idCompliment).value=data['tel'];
                    document.getElementById('Fax'+idCompliment).value=data['fax'];
                    document.getElementById('Site'+idCompliment).value=data['site'];
                    document.getElementById('Resp'+idCompliment).value=data['nomResp'];
                    document.getElementById('RespPrenom'+idCompliment).value=data['prenomResp'];
                    document.getElementById('TelResp'+idCompliment).value=data['telResp'];
                    document.getElementById('MailResp'+idCompliment).value=data['mailResp'];
                    document.getElementById('TypeSoc'+idCompliment).value=data['type'];
                    document.getElementById('Taille'+idCompliment).value=data['taille'];
                    document.getElementById('Secteur'+idCompliment).value=data['secteur'];
                    button.style.borderColor = "red";

                }else {

                     button.style.borderColor = "green";

                 }

                DeleteWaiter();
            }

        });

    }




</script>
{% endblock %}
</body>
</html>

