{% extends "AdminBundle:Admin:iFrameContent.html.twig" %}
{% block title %}Ajouter mission{% endblock %}

{% block Content %}

    <div class="row" style="background-color:  rgb(238, 241, 246);margin: 0;overflow-y: auto;height: 100%">

        <div class="col-xs-9"
             style="background: rgb(238, 241, 246); height: 100%;">



            <div class="col-xs-12" style="margin-bottom: 50px">
                <div id="info_mission" class="list-group affichage">

                    <form class="formulaire" id="formMission" action="{{ path('missionModif') }}" method="post" enctype="multipart/form-data">

                        <input type="hidden" value="{{ mission.getId }}" id="id" name="_ID">
                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Codemission">Code mission :</label>
                            <input value="{{mission.getCodemission}}" type="text" class="champ form-control" id="Profil" name="_Codemission" required maxlength="45" readonly="readonly">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Profil">Profil :</label>
                            <textarea style="height: 100px;width:800px" type="text" class="champ form-control" id="Profil" name="_Profil" required maxlength="255">{{mission.getProfil}} </textarea>
                        </div>
                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Intitule">Intitule :</label>
                            <input value="{{mission.getIntitule}}" type="text" class="champ form-control" id="Intitule" name="_Intitule" maxlength="75">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Domaine">Domaine :</label>
                            <input value="{{mission.getDomaine}}" type="text" class="champ form-control" id="Domaine" name="_Domaine" maxlength="45">
                        </div>


                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Etat">Etat :</label>
                            <input value="{{mission.getEtat}}" type="text" class="champ form-control" id="Etat" name="_Etat" maxlength="45">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="TypeContrat">TypeContrat :</label>
                            <input value="{{mission.getTypeContrat}}" type="text" class="champ form-control" id="TypeContrat" name="_TypeContrat" maxlength="45">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Remuneration">Remuneration :</label>
                            <input value="{{mission.getRemuneration}}" type="text" class="champ form-control" id="Remuneration" name="_Remuneration" maxlength="11">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="NomContact">NomContact :</label>
                            <input value="{{mission.getNomContact}}" type="text" class="champ form-control" id="NomContact" name="_NomContact" maxlength="45">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="PrenomContact">PrenomContact :</label>
                            <input value="{{mission.getPrenomContact}}" type="text" class="champ form-control" id="PrenomContact" name="_PrenomContact" maxlength="45">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Emailcontact">Emailcontact :</label>
                            <input value="{{mission.getEmailcontact}}" type="text" class="champ form-control" id="Emailcontact" name="_Emailcontact" maxlength="45">
                        </div>

                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px;" for="Datedebut">Datedebut :</label>
                            <input value="{{mission.getDatedebut|date('d/m/Y')}}" type="date" data-date='{"buttonOnly": true, "calculateWidth": false}' id="Datedebut" name="_Datedebut" >
                        </div>
                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 60px; max-width: 100%" for="Datefin">Datefin :</label>
                            <input value="{{mission.getDatefin|date('d/m/Y')}}" type="date" data-date='{"buttonOnly": true, "calculateWidth": false}'  id="Datefin" name="_Datefin" >
                        </div>
                        <div class="inputcontainer">
                            <label class="list-group-item" style="height: 280px;word-wrap: break-word;hyphens: auto;max-width: 1000px" for="Descriptif">Descriptif :</label>
                            <textarea  style="height: 280px;width:700px" type="text" class="champ form-control" id="Descriptif" name="_Descriptif" maxlength="255">{{mission.getDescriptif}}</textarea>
                        </div>
                    </form>
                </div>





            </div>
        </div>

        <div class="col-xs-3"
             style="height: 100%;">
            <div class="list-group"
                 style="margin: 15px 0 0 15px;height: 100%; background-color: white;">

                <button onclick="envoyer()" type="button" class="list-group-item rightMenu" >
                    <div class="col-xs-12"  >valider</div>

                </button>
                <button onclick="supprimerMission('{{ path('supprimer_Mission',{'id': mission.getId }) }}')" type="button" class="list-group-item rightMenu" >
                    <div class="col-xs-12"  >Supprimer Mission</div>

                </button>

            </div>
        </div>

    </div>

    <script src="//code.jquery.com/jquery.min.js"></script>
    <script src="//cdn.jsdelivr.net/webshim/1.14.5/polyfiller.js"></script>
    <script>
        webshims.polyfill('forms forms-ext');
    </script>
    <script>
        function supprimerMission(path) {
            $.ajax({
                type: 'get',
                url: path,
                error: function () {
                    alert('Une erreur s\'est produite');
                },
                success: function () {
                    window.parent.location.reload();
                }
            });

        };
        function envoyer(){
            document.getElementById('formMission').submit();
            document.getElementById('formMission').onclick();
        }
        function expire(route) {
            $.ajax({
                type: 'get',
                url: route,
                error: function (response) {
                    console.log(response);
                },
                success: function (data) {
                    if (data['succes'] == '0') {
                        document.getElementById("expired").style.backgroundColor = '#94C400';
                        document.getElementById("expired").firstElementChild.innerHTML = 'Activer';
                        window.parent.document.getElementById('expire{{ mission.getId }}').style.backgroundColor = '#94C400';
                    }
                    else {
                        document.getElementById("expired").style.backgroundColor = 'red';
                        document.getElementById("expired").firstElementChild.innerHTML = 'DÃ©sactiver';
                        window.parent.document.getElementById('expire{{ mission.getId }}').style.backgroundColor = 'red';
                    }

                }
            });

        };
        $(function(){
            $('[type="date"].min-today').prop('min', function(){
                return new Date().toJSON().split('T')[0];
            });
        });


    </script>
{% endblock %}